{
  "version": 3,
  "sources": ["../../node_modules/morphdom/dist/morphdom-esm.js", "../../node_modules/dot-prop/index.js", "../../js_src/State.js", "../../js_src/ComponentState.js", "../../js_src/ValidatorError.js", "../../node_modules/expr-eval/dist/index.mjs", "../../js_src/U.js", "../../js_src/components/BaseComponent.js", "../../js_src/components/ChecklistComponent.js", "../../node_modules/html-es6cape/dist/index.esm.js", "../../node_modules/html-element-attributes/index.js", "../../node_modules/html-template-tag/dist/index.esm.js", "../../js_src/components/DateComponent.js", "../../js_src/components/DatetimeComponent.js", "../../js_src/components/DownloadComponent.js", "../../js_src/components/DropdownComponent.js", "../../js_src/components/EmailComponent.js", "../../js_src/components/FieldsetComponent.js", "../../js_src/components/HiddenComponent.js", "../../js_src/components/HrComponent.js", "../../js_src/components/ImageComponent.js", "../../js_src/components/MarkdownComponent.js", "../../js_src/components/NumberinputComponent.js", "../../js_src/components/RadiosetComponent.js", "../../node_modules/signature_pad/src/point.ts", "../../node_modules/signature_pad/src/bezier.ts", "../../node_modules/signature_pad/src/signature_event_target.ts", "../../node_modules/signature_pad/src/throttle.ts", "../../node_modules/signature_pad/src/signature_pad.ts", "../../js_src/components/SignatureComponent.js", "../../js_src/components/TableComponent.js", "../../js_src/components/TextareaComponent.js", "../../js_src/components/TextinputComponent.js", "../../js_src/components/TimeComponent.js", "../../js_src/components/UploadComponent.js", "../../js_src/components/FormComponent.js"],
  "sourcesContent": ["var DOCUMENT_FRAGMENT_NODE = 11;\n\nfunction morphAttrs(fromNode, toNode) {\n    var toNodeAttrs = toNode.attributes;\n    var attr;\n    var attrName;\n    var attrNamespaceURI;\n    var attrValue;\n    var fromValue;\n\n    // document-fragments dont have attributes so lets not do anything\n    if (toNode.nodeType === DOCUMENT_FRAGMENT_NODE || fromNode.nodeType === DOCUMENT_FRAGMENT_NODE) {\n      return;\n    }\n\n    // update attributes on original DOM element\n    for (var i = toNodeAttrs.length - 1; i >= 0; i--) {\n        attr = toNodeAttrs[i];\n        attrName = attr.name;\n        attrNamespaceURI = attr.namespaceURI;\n        attrValue = attr.value;\n\n        if (attrNamespaceURI) {\n            attrName = attr.localName || attrName;\n            fromValue = fromNode.getAttributeNS(attrNamespaceURI, attrName);\n\n            if (fromValue !== attrValue) {\n                if (attr.prefix === 'xmlns'){\n                    attrName = attr.name; // It's not allowed to set an attribute with the XMLNS namespace without specifying the `xmlns` prefix\n                }\n                fromNode.setAttributeNS(attrNamespaceURI, attrName, attrValue);\n            }\n        } else {\n            fromValue = fromNode.getAttribute(attrName);\n\n            if (fromValue !== attrValue) {\n                fromNode.setAttribute(attrName, attrValue);\n            }\n        }\n    }\n\n    // Remove any extra attributes found on the original DOM element that\n    // weren't found on the target element.\n    var fromNodeAttrs = fromNode.attributes;\n\n    for (var d = fromNodeAttrs.length - 1; d >= 0; d--) {\n        attr = fromNodeAttrs[d];\n        attrName = attr.name;\n        attrNamespaceURI = attr.namespaceURI;\n\n        if (attrNamespaceURI) {\n            attrName = attr.localName || attrName;\n\n            if (!toNode.hasAttributeNS(attrNamespaceURI, attrName)) {\n                fromNode.removeAttributeNS(attrNamespaceURI, attrName);\n            }\n        } else {\n            if (!toNode.hasAttribute(attrName)) {\n                fromNode.removeAttribute(attrName);\n            }\n        }\n    }\n}\n\nvar range; // Create a range object for efficently rendering strings to elements.\nvar NS_XHTML = 'http://www.w3.org/1999/xhtml';\n\nvar doc = typeof document === 'undefined' ? undefined : document;\nvar HAS_TEMPLATE_SUPPORT = !!doc && 'content' in doc.createElement('template');\nvar HAS_RANGE_SUPPORT = !!doc && doc.createRange && 'createContextualFragment' in doc.createRange();\n\nfunction createFragmentFromTemplate(str) {\n    var template = doc.createElement('template');\n    template.innerHTML = str;\n    return template.content.childNodes[0];\n}\n\nfunction createFragmentFromRange(str) {\n    if (!range) {\n        range = doc.createRange();\n        range.selectNode(doc.body);\n    }\n\n    var fragment = range.createContextualFragment(str);\n    return fragment.childNodes[0];\n}\n\nfunction createFragmentFromWrap(str) {\n    var fragment = doc.createElement('body');\n    fragment.innerHTML = str;\n    return fragment.childNodes[0];\n}\n\n/**\n * This is about the same\n * var html = new DOMParser().parseFromString(str, 'text/html');\n * return html.body.firstChild;\n *\n * @method toElement\n * @param {String} str\n */\nfunction toElement(str) {\n    str = str.trim();\n    if (HAS_TEMPLATE_SUPPORT) {\n      // avoid restrictions on content for things like `<tr><th>Hi</th></tr>` which\n      // createContextualFragment doesn't support\n      // <template> support not available in IE\n      return createFragmentFromTemplate(str);\n    } else if (HAS_RANGE_SUPPORT) {\n      return createFragmentFromRange(str);\n    }\n\n    return createFragmentFromWrap(str);\n}\n\n/**\n * Returns true if two node's names are the same.\n *\n * NOTE: We don't bother checking `namespaceURI` because you will never find two HTML elements with the same\n *       nodeName and different namespace URIs.\n *\n * @param {Element} a\n * @param {Element} b The target element\n * @return {boolean}\n */\nfunction compareNodeNames(fromEl, toEl) {\n    var fromNodeName = fromEl.nodeName;\n    var toNodeName = toEl.nodeName;\n    var fromCodeStart, toCodeStart;\n\n    if (fromNodeName === toNodeName) {\n        return true;\n    }\n\n    fromCodeStart = fromNodeName.charCodeAt(0);\n    toCodeStart = toNodeName.charCodeAt(0);\n\n    // If the target element is a virtual DOM node or SVG node then we may\n    // need to normalize the tag name before comparing. Normal HTML elements that are\n    // in the \"http://www.w3.org/1999/xhtml\"\n    // are converted to upper case\n    if (fromCodeStart <= 90 && toCodeStart >= 97) { // from is upper and to is lower\n        return fromNodeName === toNodeName.toUpperCase();\n    } else if (toCodeStart <= 90 && fromCodeStart >= 97) { // to is upper and from is lower\n        return toNodeName === fromNodeName.toUpperCase();\n    } else {\n        return false;\n    }\n}\n\n/**\n * Create an element, optionally with a known namespace URI.\n *\n * @param {string} name the element name, e.g. 'div' or 'svg'\n * @param {string} [namespaceURI] the element's namespace URI, i.e. the value of\n * its `xmlns` attribute or its inferred namespace.\n *\n * @return {Element}\n */\nfunction createElementNS(name, namespaceURI) {\n    return !namespaceURI || namespaceURI === NS_XHTML ?\n        doc.createElement(name) :\n        doc.createElementNS(namespaceURI, name);\n}\n\n/**\n * Copies the children of one DOM element to another DOM element\n */\nfunction moveChildren(fromEl, toEl) {\n    var curChild = fromEl.firstChild;\n    while (curChild) {\n        var nextChild = curChild.nextSibling;\n        toEl.appendChild(curChild);\n        curChild = nextChild;\n    }\n    return toEl;\n}\n\nfunction syncBooleanAttrProp(fromEl, toEl, name) {\n    if (fromEl[name] !== toEl[name]) {\n        fromEl[name] = toEl[name];\n        if (fromEl[name]) {\n            fromEl.setAttribute(name, '');\n        } else {\n            fromEl.removeAttribute(name);\n        }\n    }\n}\n\nvar specialElHandlers = {\n    OPTION: function(fromEl, toEl) {\n        var parentNode = fromEl.parentNode;\n        if (parentNode) {\n            var parentName = parentNode.nodeName.toUpperCase();\n            if (parentName === 'OPTGROUP') {\n                parentNode = parentNode.parentNode;\n                parentName = parentNode && parentNode.nodeName.toUpperCase();\n            }\n            if (parentName === 'SELECT' && !parentNode.hasAttribute('multiple')) {\n                if (fromEl.hasAttribute('selected') && !toEl.selected) {\n                    // Workaround for MS Edge bug where the 'selected' attribute can only be\n                    // removed if set to a non-empty value:\n                    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12087679/\n                    fromEl.setAttribute('selected', 'selected');\n                    fromEl.removeAttribute('selected');\n                }\n                // We have to reset select element's selectedIndex to -1, otherwise setting\n                // fromEl.selected using the syncBooleanAttrProp below has no effect.\n                // The correct selectedIndex will be set in the SELECT special handler below.\n                parentNode.selectedIndex = -1;\n            }\n        }\n        syncBooleanAttrProp(fromEl, toEl, 'selected');\n    },\n    /**\n     * The \"value\" attribute is special for the <input> element since it sets\n     * the initial value. Changing the \"value\" attribute without changing the\n     * \"value\" property will have no effect since it is only used to the set the\n     * initial value.  Similar for the \"checked\" attribute, and \"disabled\".\n     */\n    INPUT: function(fromEl, toEl) {\n        syncBooleanAttrProp(fromEl, toEl, 'checked');\n        syncBooleanAttrProp(fromEl, toEl, 'disabled');\n\n        if (fromEl.value !== toEl.value) {\n            fromEl.value = toEl.value;\n        }\n\n        if (!toEl.hasAttribute('value')) {\n            fromEl.removeAttribute('value');\n        }\n    },\n\n    TEXTAREA: function(fromEl, toEl) {\n        var newValue = toEl.value;\n        if (fromEl.value !== newValue) {\n            fromEl.value = newValue;\n        }\n\n        var firstChild = fromEl.firstChild;\n        if (firstChild) {\n            // Needed for IE. Apparently IE sets the placeholder as the\n            // node value and vise versa. This ignores an empty update.\n            var oldValue = firstChild.nodeValue;\n\n            if (oldValue == newValue || (!newValue && oldValue == fromEl.placeholder)) {\n                return;\n            }\n\n            firstChild.nodeValue = newValue;\n        }\n    },\n    SELECT: function(fromEl, toEl) {\n        if (!toEl.hasAttribute('multiple')) {\n            var selectedIndex = -1;\n            var i = 0;\n            // We have to loop through children of fromEl, not toEl since nodes can be moved\n            // from toEl to fromEl directly when morphing.\n            // At the time this special handler is invoked, all children have already been morphed\n            // and appended to / removed from fromEl, so using fromEl here is safe and correct.\n            var curChild = fromEl.firstChild;\n            var optgroup;\n            var nodeName;\n            while(curChild) {\n                nodeName = curChild.nodeName && curChild.nodeName.toUpperCase();\n                if (nodeName === 'OPTGROUP') {\n                    optgroup = curChild;\n                    curChild = optgroup.firstChild;\n                } else {\n                    if (nodeName === 'OPTION') {\n                        if (curChild.hasAttribute('selected')) {\n                            selectedIndex = i;\n                            break;\n                        }\n                        i++;\n                    }\n                    curChild = curChild.nextSibling;\n                    if (!curChild && optgroup) {\n                        curChild = optgroup.nextSibling;\n                        optgroup = null;\n                    }\n                }\n            }\n\n            fromEl.selectedIndex = selectedIndex;\n        }\n    }\n};\n\nvar ELEMENT_NODE = 1;\nvar DOCUMENT_FRAGMENT_NODE$1 = 11;\nvar TEXT_NODE = 3;\nvar COMMENT_NODE = 8;\n\nfunction noop() {}\n\nfunction defaultGetNodeKey(node) {\n  if (node) {\n    return (node.getAttribute && node.getAttribute('id')) || node.id;\n  }\n}\n\nfunction morphdomFactory(morphAttrs) {\n\n  return function morphdom(fromNode, toNode, options) {\n    if (!options) {\n      options = {};\n    }\n\n    if (typeof toNode === 'string') {\n      if (fromNode.nodeName === '#document' || fromNode.nodeName === 'HTML' || fromNode.nodeName === 'BODY') {\n        var toNodeHtml = toNode;\n        toNode = doc.createElement('html');\n        toNode.innerHTML = toNodeHtml;\n      } else {\n        toNode = toElement(toNode);\n      }\n    } else if (toNode.nodeType === DOCUMENT_FRAGMENT_NODE$1) {\n      toNode = toNode.firstElementChild;\n    }\n\n    var getNodeKey = options.getNodeKey || defaultGetNodeKey;\n    var onBeforeNodeAdded = options.onBeforeNodeAdded || noop;\n    var onNodeAdded = options.onNodeAdded || noop;\n    var onBeforeElUpdated = options.onBeforeElUpdated || noop;\n    var onElUpdated = options.onElUpdated || noop;\n    var onBeforeNodeDiscarded = options.onBeforeNodeDiscarded || noop;\n    var onNodeDiscarded = options.onNodeDiscarded || noop;\n    var onBeforeElChildrenUpdated = options.onBeforeElChildrenUpdated || noop;\n    var skipFromChildren = options.skipFromChildren || noop;\n    var addChild = options.addChild || function(parent, child){ return parent.appendChild(child); };\n    var childrenOnly = options.childrenOnly === true;\n\n    // This object is used as a lookup to quickly find all keyed elements in the original DOM tree.\n    var fromNodesLookup = Object.create(null);\n    var keyedRemovalList = [];\n\n    function addKeyedRemoval(key) {\n      keyedRemovalList.push(key);\n    }\n\n    function walkDiscardedChildNodes(node, skipKeyedNodes) {\n      if (node.nodeType === ELEMENT_NODE) {\n        var curChild = node.firstChild;\n        while (curChild) {\n\n          var key = undefined;\n\n          if (skipKeyedNodes && (key = getNodeKey(curChild))) {\n            // If we are skipping keyed nodes then we add the key\n            // to a list so that it can be handled at the very end.\n            addKeyedRemoval(key);\n          } else {\n            // Only report the node as discarded if it is not keyed. We do this because\n            // at the end we loop through all keyed elements that were unmatched\n            // and then discard them in one final pass.\n            onNodeDiscarded(curChild);\n            if (curChild.firstChild) {\n              walkDiscardedChildNodes(curChild, skipKeyedNodes);\n            }\n          }\n\n          curChild = curChild.nextSibling;\n        }\n      }\n    }\n\n    /**\n    * Removes a DOM node out of the original DOM\n    *\n    * @param  {Node} node The node to remove\n    * @param  {Node} parentNode The nodes parent\n    * @param  {Boolean} skipKeyedNodes If true then elements with keys will be skipped and not discarded.\n    * @return {undefined}\n    */\n    function removeNode(node, parentNode, skipKeyedNodes) {\n      if (onBeforeNodeDiscarded(node) === false) {\n        return;\n      }\n\n      if (parentNode) {\n        parentNode.removeChild(node);\n      }\n\n      onNodeDiscarded(node);\n      walkDiscardedChildNodes(node, skipKeyedNodes);\n    }\n\n    // // TreeWalker implementation is no faster, but keeping this around in case this changes in the future\n    // function indexTree(root) {\n    //     var treeWalker = document.createTreeWalker(\n    //         root,\n    //         NodeFilter.SHOW_ELEMENT);\n    //\n    //     var el;\n    //     while((el = treeWalker.nextNode())) {\n    //         var key = getNodeKey(el);\n    //         if (key) {\n    //             fromNodesLookup[key] = el;\n    //         }\n    //     }\n    // }\n\n    // // NodeIterator implementation is no faster, but keeping this around in case this changes in the future\n    //\n    // function indexTree(node) {\n    //     var nodeIterator = document.createNodeIterator(node, NodeFilter.SHOW_ELEMENT);\n    //     var el;\n    //     while((el = nodeIterator.nextNode())) {\n    //         var key = getNodeKey(el);\n    //         if (key) {\n    //             fromNodesLookup[key] = el;\n    //         }\n    //     }\n    // }\n\n    function indexTree(node) {\n      if (node.nodeType === ELEMENT_NODE || node.nodeType === DOCUMENT_FRAGMENT_NODE$1) {\n        var curChild = node.firstChild;\n        while (curChild) {\n          var key = getNodeKey(curChild);\n          if (key) {\n            fromNodesLookup[key] = curChild;\n          }\n\n          // Walk recursively\n          indexTree(curChild);\n\n          curChild = curChild.nextSibling;\n        }\n      }\n    }\n\n    indexTree(fromNode);\n\n    function handleNodeAdded(el) {\n      onNodeAdded(el);\n\n      var curChild = el.firstChild;\n      while (curChild) {\n        var nextSibling = curChild.nextSibling;\n\n        var key = getNodeKey(curChild);\n        if (key) {\n          var unmatchedFromEl = fromNodesLookup[key];\n          // if we find a duplicate #id node in cache, replace `el` with cache value\n          // and morph it to the child node.\n          if (unmatchedFromEl && compareNodeNames(curChild, unmatchedFromEl)) {\n            curChild.parentNode.replaceChild(unmatchedFromEl, curChild);\n            morphEl(unmatchedFromEl, curChild);\n          } else {\n            handleNodeAdded(curChild);\n          }\n        } else {\n          // recursively call for curChild and it's children to see if we find something in\n          // fromNodesLookup\n          handleNodeAdded(curChild);\n        }\n\n        curChild = nextSibling;\n      }\n    }\n\n    function cleanupFromEl(fromEl, curFromNodeChild, curFromNodeKey) {\n      // We have processed all of the \"to nodes\". If curFromNodeChild is\n      // non-null then we still have some from nodes left over that need\n      // to be removed\n      while (curFromNodeChild) {\n        var fromNextSibling = curFromNodeChild.nextSibling;\n        if ((curFromNodeKey = getNodeKey(curFromNodeChild))) {\n          // Since the node is keyed it might be matched up later so we defer\n          // the actual removal to later\n          addKeyedRemoval(curFromNodeKey);\n        } else {\n          // NOTE: we skip nested keyed nodes from being removed since there is\n          //       still a chance they will be matched up later\n          removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n        }\n        curFromNodeChild = fromNextSibling;\n      }\n    }\n\n    function morphEl(fromEl, toEl, childrenOnly) {\n      var toElKey = getNodeKey(toEl);\n\n      if (toElKey) {\n        // If an element with an ID is being morphed then it will be in the final\n        // DOM so clear it out of the saved elements collection\n        delete fromNodesLookup[toElKey];\n      }\n\n      if (!childrenOnly) {\n        // optional\n        var beforeUpdateResult = onBeforeElUpdated(fromEl, toEl);\n        if (beforeUpdateResult === false) {\n          return;\n        } else if (beforeUpdateResult instanceof HTMLElement) {\n          fromEl = beforeUpdateResult;\n          // reindex the new fromEl in case it's not in the same\n          // tree as the original fromEl\n          // (Phoenix LiveView sometimes returns a cloned tree,\n          //  but keyed lookups would still point to the original tree)\n          indexTree(fromEl);\n        }\n\n        // update attributes on original DOM element first\n        morphAttrs(fromEl, toEl);\n        // optional\n        onElUpdated(fromEl);\n\n        if (onBeforeElChildrenUpdated(fromEl, toEl) === false) {\n          return;\n        }\n      }\n\n      if (fromEl.nodeName !== 'TEXTAREA') {\n        morphChildren(fromEl, toEl);\n      } else {\n        specialElHandlers.TEXTAREA(fromEl, toEl);\n      }\n    }\n\n    function morphChildren(fromEl, toEl) {\n      var skipFrom = skipFromChildren(fromEl, toEl);\n      var curToNodeChild = toEl.firstChild;\n      var curFromNodeChild = fromEl.firstChild;\n      var curToNodeKey;\n      var curFromNodeKey;\n\n      var fromNextSibling;\n      var toNextSibling;\n      var matchingFromEl;\n\n      // walk the children\n      outer: while (curToNodeChild) {\n        toNextSibling = curToNodeChild.nextSibling;\n        curToNodeKey = getNodeKey(curToNodeChild);\n\n        // walk the fromNode children all the way through\n        while (!skipFrom && curFromNodeChild) {\n          fromNextSibling = curFromNodeChild.nextSibling;\n\n          if (curToNodeChild.isSameNode && curToNodeChild.isSameNode(curFromNodeChild)) {\n            curToNodeChild = toNextSibling;\n            curFromNodeChild = fromNextSibling;\n            continue outer;\n          }\n\n          curFromNodeKey = getNodeKey(curFromNodeChild);\n\n          var curFromNodeType = curFromNodeChild.nodeType;\n\n          // this means if the curFromNodeChild doesnt have a match with the curToNodeChild\n          var isCompatible = undefined;\n\n          if (curFromNodeType === curToNodeChild.nodeType) {\n            if (curFromNodeType === ELEMENT_NODE) {\n              // Both nodes being compared are Element nodes\n\n              if (curToNodeKey) {\n                // The target node has a key so we want to match it up with the correct element\n                // in the original DOM tree\n                if (curToNodeKey !== curFromNodeKey) {\n                  // The current element in the original DOM tree does not have a matching key so\n                  // let's check our lookup to see if there is a matching element in the original\n                  // DOM tree\n                  if ((matchingFromEl = fromNodesLookup[curToNodeKey])) {\n                    if (fromNextSibling === matchingFromEl) {\n                      // Special case for single element removals. To avoid removing the original\n                      // DOM node out of the tree (since that can break CSS transitions, etc.),\n                      // we will instead discard the current node and wait until the next\n                      // iteration to properly match up the keyed target element with its matching\n                      // element in the original tree\n                      isCompatible = false;\n                    } else {\n                      // We found a matching keyed element somewhere in the original DOM tree.\n                      // Let's move the original DOM node into the current position and morph\n                      // it.\n\n                      // NOTE: We use insertBefore instead of replaceChild because we want to go through\n                      // the `removeNode()` function for the node that is being discarded so that\n                      // all lifecycle hooks are correctly invoked\n                      fromEl.insertBefore(matchingFromEl, curFromNodeChild);\n\n                      // fromNextSibling = curFromNodeChild.nextSibling;\n\n                      if (curFromNodeKey) {\n                        // Since the node is keyed it might be matched up later so we defer\n                        // the actual removal to later\n                        addKeyedRemoval(curFromNodeKey);\n                      } else {\n                        // NOTE: we skip nested keyed nodes from being removed since there is\n                        //       still a chance they will be matched up later\n                        removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n                      }\n\n                      curFromNodeChild = matchingFromEl;\n                      curFromNodeKey = getNodeKey(curFromNodeChild);\n                    }\n                  } else {\n                    // The nodes are not compatible since the \"to\" node has a key and there\n                    // is no matching keyed node in the source tree\n                    isCompatible = false;\n                  }\n                }\n              } else if (curFromNodeKey) {\n                // The original has a key\n                isCompatible = false;\n              }\n\n              isCompatible = isCompatible !== false && compareNodeNames(curFromNodeChild, curToNodeChild);\n              if (isCompatible) {\n                // We found compatible DOM elements so transform\n                // the current \"from\" node to match the current\n                // target DOM node.\n                // MORPH\n                morphEl(curFromNodeChild, curToNodeChild);\n              }\n\n            } else if (curFromNodeType === TEXT_NODE || curFromNodeType == COMMENT_NODE) {\n              // Both nodes being compared are Text or Comment nodes\n              isCompatible = true;\n              // Simply update nodeValue on the original node to\n              // change the text value\n              if (curFromNodeChild.nodeValue !== curToNodeChild.nodeValue) {\n                curFromNodeChild.nodeValue = curToNodeChild.nodeValue;\n              }\n\n            }\n          }\n\n          if (isCompatible) {\n            // Advance both the \"to\" child and the \"from\" child since we found a match\n            // Nothing else to do as we already recursively called morphChildren above\n            curToNodeChild = toNextSibling;\n            curFromNodeChild = fromNextSibling;\n            continue outer;\n          }\n\n          // No compatible match so remove the old node from the DOM and continue trying to find a\n          // match in the original DOM. However, we only do this if the from node is not keyed\n          // since it is possible that a keyed node might match up with a node somewhere else in the\n          // target tree and we don't want to discard it just yet since it still might find a\n          // home in the final DOM tree. After everything is done we will remove any keyed nodes\n          // that didn't find a home\n          if (curFromNodeKey) {\n            // Since the node is keyed it might be matched up later so we defer\n            // the actual removal to later\n            addKeyedRemoval(curFromNodeKey);\n          } else {\n            // NOTE: we skip nested keyed nodes from being removed since there is\n            //       still a chance they will be matched up later\n            removeNode(curFromNodeChild, fromEl, true /* skip keyed nodes */);\n          }\n\n          curFromNodeChild = fromNextSibling;\n        } // END: while(curFromNodeChild) {}\n\n        // If we got this far then we did not find a candidate match for\n        // our \"to node\" and we exhausted all of the children \"from\"\n        // nodes. Therefore, we will just append the current \"to\" node\n        // to the end\n        if (curToNodeKey && (matchingFromEl = fromNodesLookup[curToNodeKey]) && compareNodeNames(matchingFromEl, curToNodeChild)) {\n          // MORPH\n          if(!skipFrom){ addChild(fromEl, matchingFromEl); }\n          morphEl(matchingFromEl, curToNodeChild);\n        } else {\n          var onBeforeNodeAddedResult = onBeforeNodeAdded(curToNodeChild);\n          if (onBeforeNodeAddedResult !== false) {\n            if (onBeforeNodeAddedResult) {\n              curToNodeChild = onBeforeNodeAddedResult;\n            }\n\n            if (curToNodeChild.actualize) {\n              curToNodeChild = curToNodeChild.actualize(fromEl.ownerDocument || doc);\n            }\n            addChild(fromEl, curToNodeChild);\n            handleNodeAdded(curToNodeChild);\n          }\n        }\n\n        curToNodeChild = toNextSibling;\n        curFromNodeChild = fromNextSibling;\n      }\n\n      cleanupFromEl(fromEl, curFromNodeChild, curFromNodeKey);\n\n      var specialElHandler = specialElHandlers[fromEl.nodeName];\n      if (specialElHandler) {\n        specialElHandler(fromEl, toEl);\n      }\n    } // END: morphChildren(...)\n\n    var morphedNode = fromNode;\n    var morphedNodeType = morphedNode.nodeType;\n    var toNodeType = toNode.nodeType;\n\n    if (!childrenOnly) {\n      // Handle the case where we are given two DOM nodes that are not\n      // compatible (e.g. <div> --> <span> or <div> --> TEXT)\n      if (morphedNodeType === ELEMENT_NODE) {\n        if (toNodeType === ELEMENT_NODE) {\n          if (!compareNodeNames(fromNode, toNode)) {\n            onNodeDiscarded(fromNode);\n            morphedNode = moveChildren(fromNode, createElementNS(toNode.nodeName, toNode.namespaceURI));\n          }\n        } else {\n          // Going from an element node to a text node\n          morphedNode = toNode;\n        }\n      } else if (morphedNodeType === TEXT_NODE || morphedNodeType === COMMENT_NODE) { // Text or comment node\n        if (toNodeType === morphedNodeType) {\n          if (morphedNode.nodeValue !== toNode.nodeValue) {\n            morphedNode.nodeValue = toNode.nodeValue;\n          }\n\n          return morphedNode;\n        } else {\n          // Text node to something else\n          morphedNode = toNode;\n        }\n      }\n    }\n\n    if (morphedNode === toNode) {\n      // The \"to node\" was not compatible with the \"from node\" so we had to\n      // toss out the \"from node\" and use the \"to node\"\n      onNodeDiscarded(fromNode);\n    } else {\n      if (toNode.isSameNode && toNode.isSameNode(morphedNode)) {\n        return;\n      }\n\n      morphEl(morphedNode, toNode, childrenOnly);\n\n      // We now need to loop over any keyed nodes that might need to be\n      // removed. We only do the removal if we know that the keyed node\n      // never found a match. When a keyed node is matched up we remove\n      // it out of fromNodesLookup and we use fromNodesLookup to determine\n      // if a keyed node has been matched up or not\n      if (keyedRemovalList) {\n        for (var i=0, len=keyedRemovalList.length; i<len; i++) {\n          var elToRemove = fromNodesLookup[keyedRemovalList[i]];\n          if (elToRemove) {\n            removeNode(elToRemove, elToRemove.parentNode, false);\n          }\n        }\n      }\n    }\n\n    if (!childrenOnly && morphedNode !== fromNode && fromNode.parentNode) {\n      if (morphedNode.actualize) {\n        morphedNode = morphedNode.actualize(fromNode.ownerDocument || doc);\n      }\n      // If we had to swap out the from node with a new node because the old\n      // node was not compatible with the target node then we need to\n      // replace the old DOM node in the original DOM tree. This is only\n      // possible if the original DOM node was part of a DOM tree which\n      // we know is the case if it has a parent node.\n      fromNode.parentNode.replaceChild(morphedNode, fromNode);\n    }\n\n    return morphedNode;\n  };\n}\n\nvar morphdom = morphdomFactory(morphAttrs);\n\nexport default morphdom;\n", "const isObject = value => {\n\tconst type = typeof value;\n\treturn value !== null && (type === 'object' || type === 'function');\n};\n\nconst isEmptyObject = value => isObject(value) && Object.keys(value).length === 0;\n\nconst disallowedKeys = new Set([\n\t'__proto__',\n\t'prototype',\n\t'constructor',\n]);\n\nconst digits = new Set('0123456789');\n\nfunction getPathSegments(path) {\n\tconst parts = [];\n\tlet currentSegment = '';\n\tlet currentPart = 'start';\n\tlet isIgnoring = false;\n\n\tfor (const character of path) {\n\t\tswitch (character) {\n\t\t\tcase '\\\\': {\n\t\t\t\tif (currentPart === 'index') {\n\t\t\t\t\tthrow new Error('Invalid character in an index');\n\t\t\t\t}\n\n\t\t\t\tif (currentPart === 'indexEnd') {\n\t\t\t\t\tthrow new Error('Invalid character after an index');\n\t\t\t\t}\n\n\t\t\t\tif (isIgnoring) {\n\t\t\t\t\tcurrentSegment += character;\n\t\t\t\t}\n\n\t\t\t\tcurrentPart = 'property';\n\t\t\t\tisIgnoring = !isIgnoring;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase '.': {\n\t\t\t\tif (currentPart === 'index') {\n\t\t\t\t\tthrow new Error('Invalid character in an index');\n\t\t\t\t}\n\n\t\t\t\tif (currentPart === 'indexEnd') {\n\t\t\t\t\tcurrentPart = 'property';\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (isIgnoring) {\n\t\t\t\t\tisIgnoring = false;\n\t\t\t\t\tcurrentSegment += character;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (disallowedKeys.has(currentSegment)) {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tparts.push(currentSegment);\n\t\t\t\tcurrentSegment = '';\n\t\t\t\tcurrentPart = 'property';\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase '[': {\n\t\t\t\tif (currentPart === 'index') {\n\t\t\t\t\tthrow new Error('Invalid character in an index');\n\t\t\t\t}\n\n\t\t\t\tif (currentPart === 'indexEnd') {\n\t\t\t\t\tcurrentPart = 'index';\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (isIgnoring) {\n\t\t\t\t\tisIgnoring = false;\n\t\t\t\t\tcurrentSegment += character;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (currentPart === 'property') {\n\t\t\t\t\tif (disallowedKeys.has(currentSegment)) {\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\n\t\t\t\t\tparts.push(currentSegment);\n\t\t\t\t\tcurrentSegment = '';\n\t\t\t\t}\n\n\t\t\t\tcurrentPart = 'index';\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase ']': {\n\t\t\t\tif (currentPart === 'index') {\n\t\t\t\t\tparts.push(Number.parseInt(currentSegment, 10));\n\t\t\t\t\tcurrentSegment = '';\n\t\t\t\t\tcurrentPart = 'indexEnd';\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (currentPart === 'indexEnd') {\n\t\t\t\t\tthrow new Error('Invalid character after an index');\n\t\t\t\t}\n\n\t\t\t\t// Falls through\n\t\t\t}\n\n\t\t\tdefault: {\n\t\t\t\tif (currentPart === 'index' && !digits.has(character)) {\n\t\t\t\t\tthrow new Error('Invalid character in an index');\n\t\t\t\t}\n\n\t\t\t\tif (currentPart === 'indexEnd') {\n\t\t\t\t\tthrow new Error('Invalid character after an index');\n\t\t\t\t}\n\n\t\t\t\tif (currentPart === 'start') {\n\t\t\t\t\tcurrentPart = 'property';\n\t\t\t\t}\n\n\t\t\t\tif (isIgnoring) {\n\t\t\t\t\tisIgnoring = false;\n\t\t\t\t\tcurrentSegment += '\\\\';\n\t\t\t\t}\n\n\t\t\t\tcurrentSegment += character;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (isIgnoring) {\n\t\tcurrentSegment += '\\\\';\n\t}\n\n\tswitch (currentPart) {\n\t\tcase 'property': {\n\t\t\tif (disallowedKeys.has(currentSegment)) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tparts.push(currentSegment);\n\n\t\t\tbreak;\n\t\t}\n\n\t\tcase 'index': {\n\t\t\tthrow new Error('Index was not closed');\n\t\t}\n\n\t\tcase 'start': {\n\t\t\tparts.push('');\n\n\t\t\tbreak;\n\t\t}\n\t\t// No default\n\t}\n\n\treturn parts;\n}\n\nfunction isStringIndex(object, key) {\n\tif (typeof key !== 'number' && Array.isArray(object)) {\n\t\tconst index = Number.parseInt(key, 10);\n\t\treturn Number.isInteger(index) && object[index] === object[key];\n\t}\n\n\treturn false;\n}\n\nfunction assertNotStringIndex(object, key) {\n\tif (isStringIndex(object, key)) {\n\t\tthrow new Error('Cannot use string index');\n\t}\n}\n\nexport function getProperty(object, path, value) {\n\tif (!isObject(object) || typeof path !== 'string') {\n\t\treturn value === undefined ? object : value;\n\t}\n\n\tconst pathArray = getPathSegments(path);\n\tif (pathArray.length === 0) {\n\t\treturn value;\n\t}\n\n\tfor (let index = 0; index < pathArray.length; index++) {\n\t\tconst key = pathArray[index];\n\n\t\tif (isStringIndex(object, key)) {\n\t\t\tobject = index === pathArray.length - 1 ? undefined : null;\n\t\t} else {\n\t\t\tobject = object[key];\n\t\t}\n\n\t\tif (object === undefined || object === null) {\n\t\t\t// `object` is either `undefined` or `null` so we want to stop the loop, and\n\t\t\t// if this is not the last bit of the path, and\n\t\t\t// if it didn't return `undefined`\n\t\t\t// it would return `null` if `object` is `null`\n\t\t\t// but we want `get({foo: null}, 'foo.bar')` to equal `undefined`, or the supplied value, not `null`\n\t\t\tif (index !== pathArray.length - 1) {\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn object === undefined ? value : object;\n}\n\nexport function setProperty(object, path, value) {\n\tif (!isObject(object) || typeof path !== 'string') {\n\t\treturn object;\n\t}\n\n\tconst root = object;\n\tconst pathArray = getPathSegments(path);\n\n\tfor (let index = 0; index < pathArray.length; index++) {\n\t\tconst key = pathArray[index];\n\n\t\tassertNotStringIndex(object, key);\n\n\t\tif (index === pathArray.length - 1) {\n\t\t\tobject[key] = value;\n\t\t} else if (!isObject(object[key])) {\n\t\t\tobject[key] = typeof pathArray[index + 1] === 'number' ? [] : {};\n\t\t}\n\n\t\tobject = object[key];\n\t}\n\n\treturn root;\n}\n\nexport function deleteProperty(object, path) {\n\tif (!isObject(object) || typeof path !== 'string') {\n\t\treturn false;\n\t}\n\n\tconst pathArray = getPathSegments(path);\n\n\tfor (let index = 0; index < pathArray.length; index++) {\n\t\tconst key = pathArray[index];\n\n\t\tassertNotStringIndex(object, key);\n\n\t\tif (index === pathArray.length - 1) {\n\t\t\tdelete object[key];\n\t\t\treturn true;\n\t\t}\n\n\t\tobject = object[key];\n\n\t\tif (!isObject(object)) {\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\nexport function hasProperty(object, path) {\n\tif (!isObject(object) || typeof path !== 'string') {\n\t\treturn false;\n\t}\n\n\tconst pathArray = getPathSegments(path);\n\tif (pathArray.length === 0) {\n\t\treturn false;\n\t}\n\n\tfor (const key of pathArray) {\n\t\tif (!isObject(object) || !(key in object) || isStringIndex(object, key)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tobject = object[key];\n\t}\n\n\treturn true;\n}\n\n// TODO: Backslashes with no effect should not be escaped\nexport function escapePath(path) {\n\tif (typeof path !== 'string') {\n\t\tthrow new TypeError('Expected a string');\n\t}\n\n\treturn path.replaceAll(/[\\\\.[]/g, '\\\\$&');\n}\n\n// The keys returned by Object.entries() for arrays are strings\nfunction entries(value) {\n\tconst result = Object.entries(value);\n\tif (Array.isArray(value)) {\n\t\treturn result.map(([key, value]) => [Number(key), value]);\n\t}\n\n\treturn result;\n}\n\nfunction stringifyPath(pathSegments) {\n\tlet result = '';\n\n\tfor (let [index, segment] of entries(pathSegments)) {\n\t\tif (typeof segment === 'number') {\n\t\t\tresult += `[${segment}]`;\n\t\t} else {\n\t\t\tsegment = escapePath(segment);\n\t\t\tresult += index === 0 ? segment : `.${segment}`;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction * deepKeysIterator(object, currentPath = []) {\n\tif (!isObject(object) || isEmptyObject(object)) {\n\t\tif (currentPath.length > 0) {\n\t\t\tyield stringifyPath(currentPath);\n\t\t}\n\n\t\treturn;\n\t}\n\n\tfor (const [key, value] of entries(object)) {\n\t\tyield * deepKeysIterator(value, [...currentPath, key]);\n\t}\n}\n\nexport function deepKeys(object) {\n\treturn [...deepKeysIterator(object)];\n}\n", "import {deleteProperty, getProperty, setProperty} from \"dot-prop\";\n\n/**\n * @typedef {Object} StateValueChangeDetail The event detail for a stateValueChangeEvent event\n * @property {string} name The ID of the field that changed\n * @property {string} value The value of the field that changed\n * @todo we may want to add the old value here as well\n */\n\n/**\n * State management class\n */\nexport class State {\n\n    static STATE_VALUE_CHANGE_EVENT = 'stateValueChangeEvent';\n\n    /** @type {Proxy<object>} The current state values */\n    values;\n\n    /** @type {Proxy<object>} Values previously set, before a component was removed */\n    oldValues;\n\n    constructor(initialValues = {}) {\n        this.values = this.#createProxy(initialValues, State.STATE_VALUE_CHANGE_EVENT);\n        this.oldValues = this.#createProxy();\n    }\n\n    /**\n     * Creates a proxy object for values\n     *\n     * Handles dot syntax access. Access to non-existing properties will return null.\n     *\n     * Optionally triggers the given event when a value is set.\n     *\n     * @param {object} initialValues\n     * @param {null|string} withEvent Emit an event with this name when a value is set\n     * @returns {Proxy<object>}\n     */\n    #createProxy(initialValues = {}, withEvent = null) {\n        return new Proxy(initialValues, {\n                set: (target, name, value) => {\n                    if (typeof name !== 'string') {\n                        throw new Error('Name must be a string');\n                    }\n\n                    if (value === null || value === undefined) {\n                        deleteProperty(target, name);\n                    } else {\n                        setProperty(target, name, value);\n                    }\n\n                    if (withEvent) {\n                        const event = new CustomEvent(withEvent, {\n                            /** @type {StateValueChangeDetail} */\n                            detail: {name, value}\n                        });\n                        document.dispatchEvent(event);\n                    }\n\n                    return true;\n                },\n\n                get: (target, name) => {\n                    if (typeof name !== 'string') {\n                        throw new Error('Name must be a string');\n                    }\n\n                    return getProperty(target, name, null);\n                }\n            }\n        );\n    }\n}\n", "import {State} from \"./State.js\";\n\n/**\n * Wraps around the main state object for easier access to the state of a single component\n */\nexport class ComponentState {\n\n    /** @type {State} the state object */\n    state;\n\n    /** @type {string} the name under which this component's data is stored */\n    #name;\n\n    /**\n     * @param {State} state\n     * @param {string} name\n     */\n    constructor(state, name) {\n        this.state = state;\n        this.#name = name;\n    }\n\n    /**\n     * Accessor to the state value of this component\n     *\n     * @returns {*}\n     */\n    get value() {\n        return this.state.values[this.#name];\n    }\n\n    /**\n     * Setter for the state of this component\n     *\n     * @param {*|null} value Setting a null value removes the key from the state\n     */\n    set value(value) {\n        this.state.values[this.#name] = value;\n    }\n\n    /**\n     * Clear the state value of this component, but keep it in the oldValues\n     */\n    clear() {\n        this.state.oldValues[this.#name] = this.state.values[this.#name];\n        this.state.values[this.#name] = null;\n    }\n\n    /**\n     * Restore the state value of this component from the oldValues\n     */\n    restore() {\n        if(this.value) return; // nothing to restore\n        this.state.values[this.#name] = this.state.oldValues[this.#name];\n        this.state.oldValues[this.#name] = null;\n    }\n\n}\n", "export class ValidatorError extends Error {\n    constructor(componentName, message = \"\", ...args) {\n        super(message, ...args);\n        this.message = message;\n        this.componentName = componentName;\n    }\n}\n", "var INUMBER = 'INUMBER';\nvar IOP1 = 'IOP1';\nvar IOP2 = 'IOP2';\nvar IOP3 = 'IOP3';\nvar IVAR = 'IVAR';\nvar IVARNAME = 'IVARNAME';\nvar IFUNCALL = 'IFUNCALL';\nvar IFUNDEF = 'IFUNDEF';\nvar IEXPR = 'IEXPR';\nvar IEXPREVAL = 'IEXPREVAL';\nvar IMEMBER = 'IMEMBER';\nvar IENDSTATEMENT = 'IENDSTATEMENT';\nvar IARRAY = 'IARRAY';\n\nfunction Instruction(type, value) {\n  this.type = type;\n  this.value = (value !== undefined && value !== null) ? value : 0;\n}\n\nInstruction.prototype.toString = function () {\n  switch (this.type) {\n    case INUMBER:\n    case IOP1:\n    case IOP2:\n    case IOP3:\n    case IVAR:\n    case IVARNAME:\n    case IENDSTATEMENT:\n      return this.value;\n    case IFUNCALL:\n      return 'CALL ' + this.value;\n    case IFUNDEF:\n      return 'DEF ' + this.value;\n    case IARRAY:\n      return 'ARRAY ' + this.value;\n    case IMEMBER:\n      return '.' + this.value;\n    default:\n      return 'Invalid Instruction';\n  }\n};\n\nfunction unaryInstruction(value) {\n  return new Instruction(IOP1, value);\n}\n\nfunction binaryInstruction(value) {\n  return new Instruction(IOP2, value);\n}\n\nfunction ternaryInstruction(value) {\n  return new Instruction(IOP3, value);\n}\n\nfunction simplify(tokens, unaryOps, binaryOps, ternaryOps, values) {\n  var nstack = [];\n  var newexpression = [];\n  var n1, n2, n3;\n  var f;\n  for (var i = 0; i < tokens.length; i++) {\n    var item = tokens[i];\n    var type = item.type;\n    if (type === INUMBER || type === IVARNAME) {\n      if (Array.isArray(item.value)) {\n        nstack.push.apply(nstack, simplify(item.value.map(function (x) {\n          return new Instruction(INUMBER, x);\n        }).concat(new Instruction(IARRAY, item.value.length)), unaryOps, binaryOps, ternaryOps, values));\n      } else {\n        nstack.push(item);\n      }\n    } else if (type === IVAR && values.hasOwnProperty(item.value)) {\n      item = new Instruction(INUMBER, values[item.value]);\n      nstack.push(item);\n    } else if (type === IOP2 && nstack.length > 1) {\n      n2 = nstack.pop();\n      n1 = nstack.pop();\n      f = binaryOps[item.value];\n      item = new Instruction(INUMBER, f(n1.value, n2.value));\n      nstack.push(item);\n    } else if (type === IOP3 && nstack.length > 2) {\n      n3 = nstack.pop();\n      n2 = nstack.pop();\n      n1 = nstack.pop();\n      if (item.value === '?') {\n        nstack.push(n1.value ? n2.value : n3.value);\n      } else {\n        f = ternaryOps[item.value];\n        item = new Instruction(INUMBER, f(n1.value, n2.value, n3.value));\n        nstack.push(item);\n      }\n    } else if (type === IOP1 && nstack.length > 0) {\n      n1 = nstack.pop();\n      f = unaryOps[item.value];\n      item = new Instruction(INUMBER, f(n1.value));\n      nstack.push(item);\n    } else if (type === IEXPR) {\n      while (nstack.length > 0) {\n        newexpression.push(nstack.shift());\n      }\n      newexpression.push(new Instruction(IEXPR, simplify(item.value, unaryOps, binaryOps, ternaryOps, values)));\n    } else if (type === IMEMBER && nstack.length > 0) {\n      n1 = nstack.pop();\n      nstack.push(new Instruction(INUMBER, n1.value[item.value]));\n    } /* else if (type === IARRAY && nstack.length >= item.value) {\n      var length = item.value;\n      while (length-- > 0) {\n        newexpression.push(nstack.pop());\n      }\n      newexpression.push(new Instruction(IARRAY, item.value));\n    } */ else {\n      while (nstack.length > 0) {\n        newexpression.push(nstack.shift());\n      }\n      newexpression.push(item);\n    }\n  }\n  while (nstack.length > 0) {\n    newexpression.push(nstack.shift());\n  }\n  return newexpression;\n}\n\nfunction substitute(tokens, variable, expr) {\n  var newexpression = [];\n  for (var i = 0; i < tokens.length; i++) {\n    var item = tokens[i];\n    var type = item.type;\n    if (type === IVAR && item.value === variable) {\n      for (var j = 0; j < expr.tokens.length; j++) {\n        var expritem = expr.tokens[j];\n        var replitem;\n        if (expritem.type === IOP1) {\n          replitem = unaryInstruction(expritem.value);\n        } else if (expritem.type === IOP2) {\n          replitem = binaryInstruction(expritem.value);\n        } else if (expritem.type === IOP3) {\n          replitem = ternaryInstruction(expritem.value);\n        } else {\n          replitem = new Instruction(expritem.type, expritem.value);\n        }\n        newexpression.push(replitem);\n      }\n    } else if (type === IEXPR) {\n      newexpression.push(new Instruction(IEXPR, substitute(item.value, variable, expr)));\n    } else {\n      newexpression.push(item);\n    }\n  }\n  return newexpression;\n}\n\nfunction evaluate(tokens, expr, values) {\n  var nstack = [];\n  var n1, n2, n3;\n  var f, args, argCount;\n\n  if (isExpressionEvaluator(tokens)) {\n    return resolveExpression(tokens, values);\n  }\n\n  var numTokens = tokens.length;\n\n  for (var i = 0; i < numTokens; i++) {\n    var item = tokens[i];\n    var type = item.type;\n    if (type === INUMBER || type === IVARNAME) {\n      nstack.push(item.value);\n    } else if (type === IOP2) {\n      n2 = nstack.pop();\n      n1 = nstack.pop();\n      if (item.value === 'and') {\n        nstack.push(n1 ? !!evaluate(n2, expr, values) : false);\n      } else if (item.value === 'or') {\n        nstack.push(n1 ? true : !!evaluate(n2, expr, values));\n      } else if (item.value === '=') {\n        f = expr.binaryOps[item.value];\n        nstack.push(f(n1, evaluate(n2, expr, values), values));\n      } else {\n        f = expr.binaryOps[item.value];\n        nstack.push(f(resolveExpression(n1, values), resolveExpression(n2, values)));\n      }\n    } else if (type === IOP3) {\n      n3 = nstack.pop();\n      n2 = nstack.pop();\n      n1 = nstack.pop();\n      if (item.value === '?') {\n        nstack.push(evaluate(n1 ? n2 : n3, expr, values));\n      } else {\n        f = expr.ternaryOps[item.value];\n        nstack.push(f(resolveExpression(n1, values), resolveExpression(n2, values), resolveExpression(n3, values)));\n      }\n    } else if (type === IVAR) {\n      if (item.value in expr.functions) {\n        nstack.push(expr.functions[item.value]);\n      } else if (item.value in expr.unaryOps && expr.parser.isOperatorEnabled(item.value)) {\n        nstack.push(expr.unaryOps[item.value]);\n      } else {\n        var v = values[item.value];\n        if (v !== undefined) {\n          nstack.push(v);\n        } else {\n          throw new Error('undefined variable: ' + item.value);\n        }\n      }\n    } else if (type === IOP1) {\n      n1 = nstack.pop();\n      f = expr.unaryOps[item.value];\n      nstack.push(f(resolveExpression(n1, values)));\n    } else if (type === IFUNCALL) {\n      argCount = item.value;\n      args = [];\n      while (argCount-- > 0) {\n        args.unshift(resolveExpression(nstack.pop(), values));\n      }\n      f = nstack.pop();\n      if (f.apply && f.call) {\n        nstack.push(f.apply(undefined, args));\n      } else {\n        throw new Error(f + ' is not a function');\n      }\n    } else if (type === IFUNDEF) {\n      // Create closure to keep references to arguments and expression\n      nstack.push((function () {\n        var n2 = nstack.pop();\n        var args = [];\n        var argCount = item.value;\n        while (argCount-- > 0) {\n          args.unshift(nstack.pop());\n        }\n        var n1 = nstack.pop();\n        var f = function () {\n          var scope = Object.assign({}, values);\n          for (var i = 0, len = args.length; i < len; i++) {\n            scope[args[i]] = arguments[i];\n          }\n          return evaluate(n2, expr, scope);\n        };\n        // f.name = n1\n        Object.defineProperty(f, 'name', {\n          value: n1,\n          writable: false\n        });\n        values[n1] = f;\n        return f;\n      })());\n    } else if (type === IEXPR) {\n      nstack.push(createExpressionEvaluator(item, expr));\n    } else if (type === IEXPREVAL) {\n      nstack.push(item);\n    } else if (type === IMEMBER) {\n      n1 = nstack.pop();\n      nstack.push(n1[item.value]);\n    } else if (type === IENDSTATEMENT) {\n      nstack.pop();\n    } else if (type === IARRAY) {\n      argCount = item.value;\n      args = [];\n      while (argCount-- > 0) {\n        args.unshift(nstack.pop());\n      }\n      nstack.push(args);\n    } else {\n      throw new Error('invalid Expression');\n    }\n  }\n  if (nstack.length > 1) {\n    throw new Error('invalid Expression (parity)');\n  }\n  // Explicitly return zero to avoid test issues caused by -0\n  return nstack[0] === 0 ? 0 : resolveExpression(nstack[0], values);\n}\n\nfunction createExpressionEvaluator(token, expr, values) {\n  if (isExpressionEvaluator(token)) return token;\n  return {\n    type: IEXPREVAL,\n    value: function (scope) {\n      return evaluate(token.value, expr, scope);\n    }\n  };\n}\n\nfunction isExpressionEvaluator(n) {\n  return n && n.type === IEXPREVAL;\n}\n\nfunction resolveExpression(n, values) {\n  return isExpressionEvaluator(n) ? n.value(values) : n;\n}\n\nfunction expressionToString(tokens, toJS) {\n  var nstack = [];\n  var n1, n2, n3;\n  var f, args, argCount;\n  for (var i = 0; i < tokens.length; i++) {\n    var item = tokens[i];\n    var type = item.type;\n    if (type === INUMBER) {\n      if (typeof item.value === 'number' && item.value < 0) {\n        nstack.push('(' + item.value + ')');\n      } else if (Array.isArray(item.value)) {\n        nstack.push('[' + item.value.map(escapeValue).join(', ') + ']');\n      } else {\n        nstack.push(escapeValue(item.value));\n      }\n    } else if (type === IOP2) {\n      n2 = nstack.pop();\n      n1 = nstack.pop();\n      f = item.value;\n      if (toJS) {\n        if (f === '^') {\n          nstack.push('Math.pow(' + n1 + ', ' + n2 + ')');\n        } else if (f === 'and') {\n          nstack.push('(!!' + n1 + ' && !!' + n2 + ')');\n        } else if (f === 'or') {\n          nstack.push('(!!' + n1 + ' || !!' + n2 + ')');\n        } else if (f === '||') {\n          nstack.push('(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }((' + n1 + '),(' + n2 + ')))');\n        } else if (f === '==') {\n          nstack.push('(' + n1 + ' === ' + n2 + ')');\n        } else if (f === '!=') {\n          nstack.push('(' + n1 + ' !== ' + n2 + ')');\n        } else if (f === '[') {\n          nstack.push(n1 + '[(' + n2 + ') | 0]');\n        } else {\n          nstack.push('(' + n1 + ' ' + f + ' ' + n2 + ')');\n        }\n      } else {\n        if (f === '[') {\n          nstack.push(n1 + '[' + n2 + ']');\n        } else {\n          nstack.push('(' + n1 + ' ' + f + ' ' + n2 + ')');\n        }\n      }\n    } else if (type === IOP3) {\n      n3 = nstack.pop();\n      n2 = nstack.pop();\n      n1 = nstack.pop();\n      f = item.value;\n      if (f === '?') {\n        nstack.push('(' + n1 + ' ? ' + n2 + ' : ' + n3 + ')');\n      } else {\n        throw new Error('invalid Expression');\n      }\n    } else if (type === IVAR || type === IVARNAME) {\n      nstack.push(item.value);\n    } else if (type === IOP1) {\n      n1 = nstack.pop();\n      f = item.value;\n      if (f === '-' || f === '+') {\n        nstack.push('(' + f + n1 + ')');\n      } else if (toJS) {\n        if (f === 'not') {\n          nstack.push('(' + '!' + n1 + ')');\n        } else if (f === '!') {\n          nstack.push('fac(' + n1 + ')');\n        } else {\n          nstack.push(f + '(' + n1 + ')');\n        }\n      } else if (f === '!') {\n        nstack.push('(' + n1 + '!)');\n      } else {\n        nstack.push('(' + f + ' ' + n1 + ')');\n      }\n    } else if (type === IFUNCALL) {\n      argCount = item.value;\n      args = [];\n      while (argCount-- > 0) {\n        args.unshift(nstack.pop());\n      }\n      f = nstack.pop();\n      nstack.push(f + '(' + args.join(', ') + ')');\n    } else if (type === IFUNDEF) {\n      n2 = nstack.pop();\n      argCount = item.value;\n      args = [];\n      while (argCount-- > 0) {\n        args.unshift(nstack.pop());\n      }\n      n1 = nstack.pop();\n      if (toJS) {\n        nstack.push('(' + n1 + ' = function(' + args.join(', ') + ') { return ' + n2 + ' })');\n      } else {\n        nstack.push('(' + n1 + '(' + args.join(', ') + ') = ' + n2 + ')');\n      }\n    } else if (type === IMEMBER) {\n      n1 = nstack.pop();\n      nstack.push(n1 + '.' + item.value);\n    } else if (type === IARRAY) {\n      argCount = item.value;\n      args = [];\n      while (argCount-- > 0) {\n        args.unshift(nstack.pop());\n      }\n      nstack.push('[' + args.join(', ') + ']');\n    } else if (type === IEXPR) {\n      nstack.push('(' + expressionToString(item.value, toJS) + ')');\n    } else if (type === IENDSTATEMENT) ; else {\n      throw new Error('invalid Expression');\n    }\n  }\n  if (nstack.length > 1) {\n    if (toJS) {\n      nstack = [ nstack.join(',') ];\n    } else {\n      nstack = [ nstack.join(';') ];\n    }\n  }\n  return String(nstack[0]);\n}\n\nfunction escapeValue(v) {\n  if (typeof v === 'string') {\n    return JSON.stringify(v).replace(/\\u2028/g, '\\\\u2028').replace(/\\u2029/g, '\\\\u2029');\n  }\n  return v;\n}\n\nfunction contains(array, obj) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i] === obj) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction getSymbols(tokens, symbols, options) {\n  options = options || {};\n  var withMembers = !!options.withMembers;\n  var prevVar = null;\n\n  for (var i = 0; i < tokens.length; i++) {\n    var item = tokens[i];\n    if (item.type === IVAR || item.type === IVARNAME) {\n      if (!withMembers && !contains(symbols, item.value)) {\n        symbols.push(item.value);\n      } else if (prevVar !== null) {\n        if (!contains(symbols, prevVar)) {\n          symbols.push(prevVar);\n        }\n        prevVar = item.value;\n      } else {\n        prevVar = item.value;\n      }\n    } else if (item.type === IMEMBER && withMembers && prevVar !== null) {\n      prevVar += '.' + item.value;\n    } else if (item.type === IEXPR) {\n      getSymbols(item.value, symbols, options);\n    } else if (prevVar !== null) {\n      if (!contains(symbols, prevVar)) {\n        symbols.push(prevVar);\n      }\n      prevVar = null;\n    }\n  }\n\n  if (prevVar !== null && !contains(symbols, prevVar)) {\n    symbols.push(prevVar);\n  }\n}\n\nfunction Expression(tokens, parser) {\n  this.tokens = tokens;\n  this.parser = parser;\n  this.unaryOps = parser.unaryOps;\n  this.binaryOps = parser.binaryOps;\n  this.ternaryOps = parser.ternaryOps;\n  this.functions = parser.functions;\n}\n\nExpression.prototype.simplify = function (values) {\n  values = values || {};\n  return new Expression(simplify(this.tokens, this.unaryOps, this.binaryOps, this.ternaryOps, values), this.parser);\n};\n\nExpression.prototype.substitute = function (variable, expr) {\n  if (!(expr instanceof Expression)) {\n    expr = this.parser.parse(String(expr));\n  }\n\n  return new Expression(substitute(this.tokens, variable, expr), this.parser);\n};\n\nExpression.prototype.evaluate = function (values) {\n  values = values || {};\n  return evaluate(this.tokens, this, values);\n};\n\nExpression.prototype.toString = function () {\n  return expressionToString(this.tokens, false);\n};\n\nExpression.prototype.symbols = function (options) {\n  options = options || {};\n  var vars = [];\n  getSymbols(this.tokens, vars, options);\n  return vars;\n};\n\nExpression.prototype.variables = function (options) {\n  options = options || {};\n  var vars = [];\n  getSymbols(this.tokens, vars, options);\n  var functions = this.functions;\n  return vars.filter(function (name) {\n    return !(name in functions);\n  });\n};\n\nExpression.prototype.toJSFunction = function (param, variables) {\n  var expr = this;\n  var f = new Function(param, 'with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return ' + expressionToString(this.simplify(variables).tokens, true) + '; }'); // eslint-disable-line no-new-func\n  return function () {\n    return f.apply(expr, arguments);\n  };\n};\n\nvar TEOF = 'TEOF';\nvar TOP = 'TOP';\nvar TNUMBER = 'TNUMBER';\nvar TSTRING = 'TSTRING';\nvar TPAREN = 'TPAREN';\nvar TBRACKET = 'TBRACKET';\nvar TCOMMA = 'TCOMMA';\nvar TNAME = 'TNAME';\nvar TSEMICOLON = 'TSEMICOLON';\n\nfunction Token(type, value, index) {\n  this.type = type;\n  this.value = value;\n  this.index = index;\n}\n\nToken.prototype.toString = function () {\n  return this.type + ': ' + this.value;\n};\n\nfunction TokenStream(parser, expression) {\n  this.pos = 0;\n  this.current = null;\n  this.unaryOps = parser.unaryOps;\n  this.binaryOps = parser.binaryOps;\n  this.ternaryOps = parser.ternaryOps;\n  this.consts = parser.consts;\n  this.expression = expression;\n  this.savedPosition = 0;\n  this.savedCurrent = null;\n  this.options = parser.options;\n  this.parser = parser;\n}\n\nTokenStream.prototype.newToken = function (type, value, pos) {\n  return new Token(type, value, pos != null ? pos : this.pos);\n};\n\nTokenStream.prototype.save = function () {\n  this.savedPosition = this.pos;\n  this.savedCurrent = this.current;\n};\n\nTokenStream.prototype.restore = function () {\n  this.pos = this.savedPosition;\n  this.current = this.savedCurrent;\n};\n\nTokenStream.prototype.next = function () {\n  if (this.pos >= this.expression.length) {\n    return this.newToken(TEOF, 'EOF');\n  }\n\n  if (this.isWhitespace() || this.isComment()) {\n    return this.next();\n  } else if (this.isRadixInteger() ||\n      this.isNumber() ||\n      this.isOperator() ||\n      this.isString() ||\n      this.isParen() ||\n      this.isBracket() ||\n      this.isComma() ||\n      this.isSemicolon() ||\n      this.isNamedOp() ||\n      this.isConst() ||\n      this.isName()) {\n    return this.current;\n  } else {\n    this.parseError('Unknown character \"' + this.expression.charAt(this.pos) + '\"');\n  }\n};\n\nTokenStream.prototype.isString = function () {\n  var r = false;\n  var startPos = this.pos;\n  var quote = this.expression.charAt(startPos);\n\n  if (quote === '\\'' || quote === '\"') {\n    var index = this.expression.indexOf(quote, startPos + 1);\n    while (index >= 0 && this.pos < this.expression.length) {\n      this.pos = index + 1;\n      if (this.expression.charAt(index - 1) !== '\\\\') {\n        var rawString = this.expression.substring(startPos + 1, index);\n        this.current = this.newToken(TSTRING, this.unescape(rawString), startPos);\n        r = true;\n        break;\n      }\n      index = this.expression.indexOf(quote, index + 1);\n    }\n  }\n  return r;\n};\n\nTokenStream.prototype.isParen = function () {\n  var c = this.expression.charAt(this.pos);\n  if (c === '(' || c === ')') {\n    this.current = this.newToken(TPAREN, c);\n    this.pos++;\n    return true;\n  }\n  return false;\n};\n\nTokenStream.prototype.isBracket = function () {\n  var c = this.expression.charAt(this.pos);\n  if ((c === '[' || c === ']') && this.isOperatorEnabled('[')) {\n    this.current = this.newToken(TBRACKET, c);\n    this.pos++;\n    return true;\n  }\n  return false;\n};\n\nTokenStream.prototype.isComma = function () {\n  var c = this.expression.charAt(this.pos);\n  if (c === ',') {\n    this.current = this.newToken(TCOMMA, ',');\n    this.pos++;\n    return true;\n  }\n  return false;\n};\n\nTokenStream.prototype.isSemicolon = function () {\n  var c = this.expression.charAt(this.pos);\n  if (c === ';') {\n    this.current = this.newToken(TSEMICOLON, ';');\n    this.pos++;\n    return true;\n  }\n  return false;\n};\n\nTokenStream.prototype.isConst = function () {\n  var startPos = this.pos;\n  var i = startPos;\n  for (; i < this.expression.length; i++) {\n    var c = this.expression.charAt(i);\n    if (c.toUpperCase() === c.toLowerCase()) {\n      if (i === this.pos || (c !== '_' && c !== '.' && (c < '0' || c > '9'))) {\n        break;\n      }\n    }\n  }\n  if (i > startPos) {\n    var str = this.expression.substring(startPos, i);\n    if (str in this.consts) {\n      this.current = this.newToken(TNUMBER, this.consts[str]);\n      this.pos += str.length;\n      return true;\n    }\n  }\n  return false;\n};\n\nTokenStream.prototype.isNamedOp = function () {\n  var startPos = this.pos;\n  var i = startPos;\n  for (; i < this.expression.length; i++) {\n    var c = this.expression.charAt(i);\n    if (c.toUpperCase() === c.toLowerCase()) {\n      if (i === this.pos || (c !== '_' && (c < '0' || c > '9'))) {\n        break;\n      }\n    }\n  }\n  if (i > startPos) {\n    var str = this.expression.substring(startPos, i);\n    if (this.isOperatorEnabled(str) && (str in this.binaryOps || str in this.unaryOps || str in this.ternaryOps)) {\n      this.current = this.newToken(TOP, str);\n      this.pos += str.length;\n      return true;\n    }\n  }\n  return false;\n};\n\nTokenStream.prototype.isName = function () {\n  var startPos = this.pos;\n  var i = startPos;\n  var hasLetter = false;\n  for (; i < this.expression.length; i++) {\n    var c = this.expression.charAt(i);\n    if (c.toUpperCase() === c.toLowerCase()) {\n      if (i === this.pos && (c === '$' || c === '_')) {\n        if (c === '_') {\n          hasLetter = true;\n        }\n        continue;\n      } else if (i === this.pos || !hasLetter || (c !== '_' && (c < '0' || c > '9'))) {\n        break;\n      }\n    } else {\n      hasLetter = true;\n    }\n  }\n  if (hasLetter) {\n    var str = this.expression.substring(startPos, i);\n    this.current = this.newToken(TNAME, str);\n    this.pos += str.length;\n    return true;\n  }\n  return false;\n};\n\nTokenStream.prototype.isWhitespace = function () {\n  var r = false;\n  var c = this.expression.charAt(this.pos);\n  while (c === ' ' || c === '\\t' || c === '\\n' || c === '\\r') {\n    r = true;\n    this.pos++;\n    if (this.pos >= this.expression.length) {\n      break;\n    }\n    c = this.expression.charAt(this.pos);\n  }\n  return r;\n};\n\nvar codePointPattern = /^[0-9a-f]{4}$/i;\n\nTokenStream.prototype.unescape = function (v) {\n  var index = v.indexOf('\\\\');\n  if (index < 0) {\n    return v;\n  }\n\n  var buffer = v.substring(0, index);\n  while (index >= 0) {\n    var c = v.charAt(++index);\n    switch (c) {\n      case '\\'':\n        buffer += '\\'';\n        break;\n      case '\"':\n        buffer += '\"';\n        break;\n      case '\\\\':\n        buffer += '\\\\';\n        break;\n      case '/':\n        buffer += '/';\n        break;\n      case 'b':\n        buffer += '\\b';\n        break;\n      case 'f':\n        buffer += '\\f';\n        break;\n      case 'n':\n        buffer += '\\n';\n        break;\n      case 'r':\n        buffer += '\\r';\n        break;\n      case 't':\n        buffer += '\\t';\n        break;\n      case 'u':\n        // interpret the following 4 characters as the hex of the unicode code point\n        var codePoint = v.substring(index + 1, index + 5);\n        if (!codePointPattern.test(codePoint)) {\n          this.parseError('Illegal escape sequence: \\\\u' + codePoint);\n        }\n        buffer += String.fromCharCode(parseInt(codePoint, 16));\n        index += 4;\n        break;\n      default:\n        throw this.parseError('Illegal escape sequence: \"\\\\' + c + '\"');\n    }\n    ++index;\n    var backslash = v.indexOf('\\\\', index);\n    buffer += v.substring(index, backslash < 0 ? v.length : backslash);\n    index = backslash;\n  }\n\n  return buffer;\n};\n\nTokenStream.prototype.isComment = function () {\n  var c = this.expression.charAt(this.pos);\n  if (c === '/' && this.expression.charAt(this.pos + 1) === '*') {\n    this.pos = this.expression.indexOf('*/', this.pos) + 2;\n    if (this.pos === 1) {\n      this.pos = this.expression.length;\n    }\n    return true;\n  }\n  return false;\n};\n\nTokenStream.prototype.isRadixInteger = function () {\n  var pos = this.pos;\n\n  if (pos >= this.expression.length - 2 || this.expression.charAt(pos) !== '0') {\n    return false;\n  }\n  ++pos;\n\n  var radix;\n  var validDigit;\n  if (this.expression.charAt(pos) === 'x') {\n    radix = 16;\n    validDigit = /^[0-9a-f]$/i;\n    ++pos;\n  } else if (this.expression.charAt(pos) === 'b') {\n    radix = 2;\n    validDigit = /^[01]$/i;\n    ++pos;\n  } else {\n    return false;\n  }\n\n  var valid = false;\n  var startPos = pos;\n\n  while (pos < this.expression.length) {\n    var c = this.expression.charAt(pos);\n    if (validDigit.test(c)) {\n      pos++;\n      valid = true;\n    } else {\n      break;\n    }\n  }\n\n  if (valid) {\n    this.current = this.newToken(TNUMBER, parseInt(this.expression.substring(startPos, pos), radix));\n    this.pos = pos;\n  }\n  return valid;\n};\n\nTokenStream.prototype.isNumber = function () {\n  var valid = false;\n  var pos = this.pos;\n  var startPos = pos;\n  var resetPos = pos;\n  var foundDot = false;\n  var foundDigits = false;\n  var c;\n\n  while (pos < this.expression.length) {\n    c = this.expression.charAt(pos);\n    if ((c >= '0' && c <= '9') || (!foundDot && c === '.')) {\n      if (c === '.') {\n        foundDot = true;\n      } else {\n        foundDigits = true;\n      }\n      pos++;\n      valid = foundDigits;\n    } else {\n      break;\n    }\n  }\n\n  if (valid) {\n    resetPos = pos;\n  }\n\n  if (c === 'e' || c === 'E') {\n    pos++;\n    var acceptSign = true;\n    var validExponent = false;\n    while (pos < this.expression.length) {\n      c = this.expression.charAt(pos);\n      if (acceptSign && (c === '+' || c === '-')) {\n        acceptSign = false;\n      } else if (c >= '0' && c <= '9') {\n        validExponent = true;\n        acceptSign = false;\n      } else {\n        break;\n      }\n      pos++;\n    }\n\n    if (!validExponent) {\n      pos = resetPos;\n    }\n  }\n\n  if (valid) {\n    this.current = this.newToken(TNUMBER, parseFloat(this.expression.substring(startPos, pos)));\n    this.pos = pos;\n  } else {\n    this.pos = resetPos;\n  }\n  return valid;\n};\n\nTokenStream.prototype.isOperator = function () {\n  var startPos = this.pos;\n  var c = this.expression.charAt(this.pos);\n\n  if (c === '+' || c === '-' || c === '*' || c === '/' || c === '%' || c === '^' || c === '?' || c === ':' || c === '.') {\n    this.current = this.newToken(TOP, c);\n  } else if (c === '\u2219' || c === '\u2022') {\n    this.current = this.newToken(TOP, '*');\n  } else if (c === '>') {\n    if (this.expression.charAt(this.pos + 1) === '=') {\n      this.current = this.newToken(TOP, '>=');\n      this.pos++;\n    } else {\n      this.current = this.newToken(TOP, '>');\n    }\n  } else if (c === '<') {\n    if (this.expression.charAt(this.pos + 1) === '=') {\n      this.current = this.newToken(TOP, '<=');\n      this.pos++;\n    } else {\n      this.current = this.newToken(TOP, '<');\n    }\n  } else if (c === '|') {\n    if (this.expression.charAt(this.pos + 1) === '|') {\n      this.current = this.newToken(TOP, '||');\n      this.pos++;\n    } else {\n      return false;\n    }\n  } else if (c === '=') {\n    if (this.expression.charAt(this.pos + 1) === '=') {\n      this.current = this.newToken(TOP, '==');\n      this.pos++;\n    } else {\n      this.current = this.newToken(TOP, c);\n    }\n  } else if (c === '!') {\n    if (this.expression.charAt(this.pos + 1) === '=') {\n      this.current = this.newToken(TOP, '!=');\n      this.pos++;\n    } else {\n      this.current = this.newToken(TOP, c);\n    }\n  } else {\n    return false;\n  }\n  this.pos++;\n\n  if (this.isOperatorEnabled(this.current.value)) {\n    return true;\n  } else {\n    this.pos = startPos;\n    return false;\n  }\n};\n\nTokenStream.prototype.isOperatorEnabled = function (op) {\n  return this.parser.isOperatorEnabled(op);\n};\n\nTokenStream.prototype.getCoordinates = function () {\n  var line = 0;\n  var column;\n  var newline = -1;\n  do {\n    line++;\n    column = this.pos - newline;\n    newline = this.expression.indexOf('\\n', newline + 1);\n  } while (newline >= 0 && newline < this.pos);\n\n  return {\n    line: line,\n    column: column\n  };\n};\n\nTokenStream.prototype.parseError = function (msg) {\n  var coords = this.getCoordinates();\n  throw new Error('parse error [' + coords.line + ':' + coords.column + ']: ' + msg);\n};\n\nfunction ParserState(parser, tokenStream, options) {\n  this.parser = parser;\n  this.tokens = tokenStream;\n  this.current = null;\n  this.nextToken = null;\n  this.next();\n  this.savedCurrent = null;\n  this.savedNextToken = null;\n  this.allowMemberAccess = options.allowMemberAccess !== false;\n}\n\nParserState.prototype.next = function () {\n  this.current = this.nextToken;\n  return (this.nextToken = this.tokens.next());\n};\n\nParserState.prototype.tokenMatches = function (token, value) {\n  if (typeof value === 'undefined') {\n    return true;\n  } else if (Array.isArray(value)) {\n    return contains(value, token.value);\n  } else if (typeof value === 'function') {\n    return value(token);\n  } else {\n    return token.value === value;\n  }\n};\n\nParserState.prototype.save = function () {\n  this.savedCurrent = this.current;\n  this.savedNextToken = this.nextToken;\n  this.tokens.save();\n};\n\nParserState.prototype.restore = function () {\n  this.tokens.restore();\n  this.current = this.savedCurrent;\n  this.nextToken = this.savedNextToken;\n};\n\nParserState.prototype.accept = function (type, value) {\n  if (this.nextToken.type === type && this.tokenMatches(this.nextToken, value)) {\n    this.next();\n    return true;\n  }\n  return false;\n};\n\nParserState.prototype.expect = function (type, value) {\n  if (!this.accept(type, value)) {\n    var coords = this.tokens.getCoordinates();\n    throw new Error('parse error [' + coords.line + ':' + coords.column + ']: Expected ' + (value || type));\n  }\n};\n\nParserState.prototype.parseAtom = function (instr) {\n  var unaryOps = this.tokens.unaryOps;\n  function isPrefixOperator(token) {\n    return token.value in unaryOps;\n  }\n\n  if (this.accept(TNAME) || this.accept(TOP, isPrefixOperator)) {\n    instr.push(new Instruction(IVAR, this.current.value));\n  } else if (this.accept(TNUMBER)) {\n    instr.push(new Instruction(INUMBER, this.current.value));\n  } else if (this.accept(TSTRING)) {\n    instr.push(new Instruction(INUMBER, this.current.value));\n  } else if (this.accept(TPAREN, '(')) {\n    this.parseExpression(instr);\n    this.expect(TPAREN, ')');\n  } else if (this.accept(TBRACKET, '[')) {\n    if (this.accept(TBRACKET, ']')) {\n      instr.push(new Instruction(IARRAY, 0));\n    } else {\n      var argCount = this.parseArrayList(instr);\n      instr.push(new Instruction(IARRAY, argCount));\n    }\n  } else {\n    throw new Error('unexpected ' + this.nextToken);\n  }\n};\n\nParserState.prototype.parseExpression = function (instr) {\n  var exprInstr = [];\n  if (this.parseUntilEndStatement(instr, exprInstr)) {\n    return;\n  }\n  this.parseVariableAssignmentExpression(exprInstr);\n  if (this.parseUntilEndStatement(instr, exprInstr)) {\n    return;\n  }\n  this.pushExpression(instr, exprInstr);\n};\n\nParserState.prototype.pushExpression = function (instr, exprInstr) {\n  for (var i = 0, len = exprInstr.length; i < len; i++) {\n    instr.push(exprInstr[i]);\n  }\n};\n\nParserState.prototype.parseUntilEndStatement = function (instr, exprInstr) {\n  if (!this.accept(TSEMICOLON)) return false;\n  if (this.nextToken && this.nextToken.type !== TEOF && !(this.nextToken.type === TPAREN && this.nextToken.value === ')')) {\n    exprInstr.push(new Instruction(IENDSTATEMENT));\n  }\n  if (this.nextToken.type !== TEOF) {\n    this.parseExpression(exprInstr);\n  }\n  instr.push(new Instruction(IEXPR, exprInstr));\n  return true;\n};\n\nParserState.prototype.parseArrayList = function (instr) {\n  var argCount = 0;\n\n  while (!this.accept(TBRACKET, ']')) {\n    this.parseExpression(instr);\n    ++argCount;\n    while (this.accept(TCOMMA)) {\n      this.parseExpression(instr);\n      ++argCount;\n    }\n  }\n\n  return argCount;\n};\n\nParserState.prototype.parseVariableAssignmentExpression = function (instr) {\n  this.parseConditionalExpression(instr);\n  while (this.accept(TOP, '=')) {\n    var varName = instr.pop();\n    var varValue = [];\n    var lastInstrIndex = instr.length - 1;\n    if (varName.type === IFUNCALL) {\n      if (!this.tokens.isOperatorEnabled('()=')) {\n        throw new Error('function definition is not permitted');\n      }\n      for (var i = 0, len = varName.value + 1; i < len; i++) {\n        var index = lastInstrIndex - i;\n        if (instr[index].type === IVAR) {\n          instr[index] = new Instruction(IVARNAME, instr[index].value);\n        }\n      }\n      this.parseVariableAssignmentExpression(varValue);\n      instr.push(new Instruction(IEXPR, varValue));\n      instr.push(new Instruction(IFUNDEF, varName.value));\n      continue;\n    }\n    if (varName.type !== IVAR && varName.type !== IMEMBER) {\n      throw new Error('expected variable for assignment');\n    }\n    this.parseVariableAssignmentExpression(varValue);\n    instr.push(new Instruction(IVARNAME, varName.value));\n    instr.push(new Instruction(IEXPR, varValue));\n    instr.push(binaryInstruction('='));\n  }\n};\n\nParserState.prototype.parseConditionalExpression = function (instr) {\n  this.parseOrExpression(instr);\n  while (this.accept(TOP, '?')) {\n    var trueBranch = [];\n    var falseBranch = [];\n    this.parseConditionalExpression(trueBranch);\n    this.expect(TOP, ':');\n    this.parseConditionalExpression(falseBranch);\n    instr.push(new Instruction(IEXPR, trueBranch));\n    instr.push(new Instruction(IEXPR, falseBranch));\n    instr.push(ternaryInstruction('?'));\n  }\n};\n\nParserState.prototype.parseOrExpression = function (instr) {\n  this.parseAndExpression(instr);\n  while (this.accept(TOP, 'or')) {\n    var falseBranch = [];\n    this.parseAndExpression(falseBranch);\n    instr.push(new Instruction(IEXPR, falseBranch));\n    instr.push(binaryInstruction('or'));\n  }\n};\n\nParserState.prototype.parseAndExpression = function (instr) {\n  this.parseComparison(instr);\n  while (this.accept(TOP, 'and')) {\n    var trueBranch = [];\n    this.parseComparison(trueBranch);\n    instr.push(new Instruction(IEXPR, trueBranch));\n    instr.push(binaryInstruction('and'));\n  }\n};\n\nvar COMPARISON_OPERATORS = ['==', '!=', '<', '<=', '>=', '>', 'in'];\n\nParserState.prototype.parseComparison = function (instr) {\n  this.parseAddSub(instr);\n  while (this.accept(TOP, COMPARISON_OPERATORS)) {\n    var op = this.current;\n    this.parseAddSub(instr);\n    instr.push(binaryInstruction(op.value));\n  }\n};\n\nvar ADD_SUB_OPERATORS = ['+', '-', '||'];\n\nParserState.prototype.parseAddSub = function (instr) {\n  this.parseTerm(instr);\n  while (this.accept(TOP, ADD_SUB_OPERATORS)) {\n    var op = this.current;\n    this.parseTerm(instr);\n    instr.push(binaryInstruction(op.value));\n  }\n};\n\nvar TERM_OPERATORS = ['*', '/', '%'];\n\nParserState.prototype.parseTerm = function (instr) {\n  this.parseFactor(instr);\n  while (this.accept(TOP, TERM_OPERATORS)) {\n    var op = this.current;\n    this.parseFactor(instr);\n    instr.push(binaryInstruction(op.value));\n  }\n};\n\nParserState.prototype.parseFactor = function (instr) {\n  var unaryOps = this.tokens.unaryOps;\n  function isPrefixOperator(token) {\n    return token.value in unaryOps;\n  }\n\n  this.save();\n  if (this.accept(TOP, isPrefixOperator)) {\n    if (this.current.value !== '-' && this.current.value !== '+') {\n      if (this.nextToken.type === TPAREN && this.nextToken.value === '(') {\n        this.restore();\n        this.parseExponential(instr);\n        return;\n      } else if (this.nextToken.type === TSEMICOLON || this.nextToken.type === TCOMMA || this.nextToken.type === TEOF || (this.nextToken.type === TPAREN && this.nextToken.value === ')')) {\n        this.restore();\n        this.parseAtom(instr);\n        return;\n      }\n    }\n\n    var op = this.current;\n    this.parseFactor(instr);\n    instr.push(unaryInstruction(op.value));\n  } else {\n    this.parseExponential(instr);\n  }\n};\n\nParserState.prototype.parseExponential = function (instr) {\n  this.parsePostfixExpression(instr);\n  while (this.accept(TOP, '^')) {\n    this.parseFactor(instr);\n    instr.push(binaryInstruction('^'));\n  }\n};\n\nParserState.prototype.parsePostfixExpression = function (instr) {\n  this.parseFunctionCall(instr);\n  while (this.accept(TOP, '!')) {\n    instr.push(unaryInstruction('!'));\n  }\n};\n\nParserState.prototype.parseFunctionCall = function (instr) {\n  var unaryOps = this.tokens.unaryOps;\n  function isPrefixOperator(token) {\n    return token.value in unaryOps;\n  }\n\n  if (this.accept(TOP, isPrefixOperator)) {\n    var op = this.current;\n    this.parseAtom(instr);\n    instr.push(unaryInstruction(op.value));\n  } else {\n    this.parseMemberExpression(instr);\n    while (this.accept(TPAREN, '(')) {\n      if (this.accept(TPAREN, ')')) {\n        instr.push(new Instruction(IFUNCALL, 0));\n      } else {\n        var argCount = this.parseArgumentList(instr);\n        instr.push(new Instruction(IFUNCALL, argCount));\n      }\n    }\n  }\n};\n\nParserState.prototype.parseArgumentList = function (instr) {\n  var argCount = 0;\n\n  while (!this.accept(TPAREN, ')')) {\n    this.parseExpression(instr);\n    ++argCount;\n    while (this.accept(TCOMMA)) {\n      this.parseExpression(instr);\n      ++argCount;\n    }\n  }\n\n  return argCount;\n};\n\nParserState.prototype.parseMemberExpression = function (instr) {\n  this.parseAtom(instr);\n  while (this.accept(TOP, '.') || this.accept(TBRACKET, '[')) {\n    var op = this.current;\n\n    if (op.value === '.') {\n      if (!this.allowMemberAccess) {\n        throw new Error('unexpected \".\", member access is not permitted');\n      }\n\n      this.expect(TNAME);\n      instr.push(new Instruction(IMEMBER, this.current.value));\n    } else if (op.value === '[') {\n      if (!this.tokens.isOperatorEnabled('[')) {\n        throw new Error('unexpected \"[]\", arrays are disabled');\n      }\n\n      this.parseExpression(instr);\n      this.expect(TBRACKET, ']');\n      instr.push(binaryInstruction('['));\n    } else {\n      throw new Error('unexpected symbol: ' + op.value);\n    }\n  }\n};\n\nfunction add(a, b) {\n  return Number(a) + Number(b);\n}\n\nfunction sub(a, b) {\n  return a - b;\n}\n\nfunction mul(a, b) {\n  return a * b;\n}\n\nfunction div(a, b) {\n  return a / b;\n}\n\nfunction mod(a, b) {\n  return a % b;\n}\n\nfunction concat(a, b) {\n  if (Array.isArray(a) && Array.isArray(b)) {\n    return a.concat(b);\n  }\n  return '' + a + b;\n}\n\nfunction equal(a, b) {\n  return a === b;\n}\n\nfunction notEqual(a, b) {\n  return a !== b;\n}\n\nfunction greaterThan(a, b) {\n  return a > b;\n}\n\nfunction lessThan(a, b) {\n  return a < b;\n}\n\nfunction greaterThanEqual(a, b) {\n  return a >= b;\n}\n\nfunction lessThanEqual(a, b) {\n  return a <= b;\n}\n\nfunction andOperator(a, b) {\n  return Boolean(a && b);\n}\n\nfunction orOperator(a, b) {\n  return Boolean(a || b);\n}\n\nfunction inOperator(a, b) {\n  return contains(b, a);\n}\n\nfunction sinh(a) {\n  return ((Math.exp(a) - Math.exp(-a)) / 2);\n}\n\nfunction cosh(a) {\n  return ((Math.exp(a) + Math.exp(-a)) / 2);\n}\n\nfunction tanh(a) {\n  if (a === Infinity) return 1;\n  if (a === -Infinity) return -1;\n  return (Math.exp(a) - Math.exp(-a)) / (Math.exp(a) + Math.exp(-a));\n}\n\nfunction asinh(a) {\n  if (a === -Infinity) return a;\n  return Math.log(a + Math.sqrt((a * a) + 1));\n}\n\nfunction acosh(a) {\n  return Math.log(a + Math.sqrt((a * a) - 1));\n}\n\nfunction atanh(a) {\n  return (Math.log((1 + a) / (1 - a)) / 2);\n}\n\nfunction log10(a) {\n  return Math.log(a) * Math.LOG10E;\n}\n\nfunction neg(a) {\n  return -a;\n}\n\nfunction not(a) {\n  return !a;\n}\n\nfunction trunc(a) {\n  return a < 0 ? Math.ceil(a) : Math.floor(a);\n}\n\nfunction random(a) {\n  return Math.random() * (a || 1);\n}\n\nfunction factorial(a) { // a!\n  return gamma(a + 1);\n}\n\nfunction isInteger(value) {\n  return isFinite(value) && (value === Math.round(value));\n}\n\nvar GAMMA_G = 4.7421875;\nvar GAMMA_P = [\n  0.99999999999999709182,\n  57.156235665862923517, -59.597960355475491248,\n  14.136097974741747174, -0.49191381609762019978,\n  0.33994649984811888699e-4,\n  0.46523628927048575665e-4, -0.98374475304879564677e-4,\n  0.15808870322491248884e-3, -0.21026444172410488319e-3,\n  0.21743961811521264320e-3, -0.16431810653676389022e-3,\n  0.84418223983852743293e-4, -0.26190838401581408670e-4,\n  0.36899182659531622704e-5\n];\n\n// Gamma function from math.js\nfunction gamma(n) {\n  var t, x;\n\n  if (isInteger(n)) {\n    if (n <= 0) {\n      return isFinite(n) ? Infinity : NaN;\n    }\n\n    if (n > 171) {\n      return Infinity; // Will overflow\n    }\n\n    var value = n - 2;\n    var res = n - 1;\n    while (value > 1) {\n      res *= value;\n      value--;\n    }\n\n    if (res === 0) {\n      res = 1; // 0! is per definition 1\n    }\n\n    return res;\n  }\n\n  if (n < 0.5) {\n    return Math.PI / (Math.sin(Math.PI * n) * gamma(1 - n));\n  }\n\n  if (n >= 171.35) {\n    return Infinity; // will overflow\n  }\n\n  if (n > 85.0) { // Extended Stirling Approx\n    var twoN = n * n;\n    var threeN = twoN * n;\n    var fourN = threeN * n;\n    var fiveN = fourN * n;\n    return Math.sqrt(2 * Math.PI / n) * Math.pow((n / Math.E), n) *\n      (1 + (1 / (12 * n)) + (1 / (288 * twoN)) - (139 / (51840 * threeN)) -\n      (571 / (2488320 * fourN)) + (163879 / (209018880 * fiveN)) +\n      (5246819 / (75246796800 * fiveN * n)));\n  }\n\n  --n;\n  x = GAMMA_P[0];\n  for (var i = 1; i < GAMMA_P.length; ++i) {\n    x += GAMMA_P[i] / (n + i);\n  }\n\n  t = n + GAMMA_G + 0.5;\n  return Math.sqrt(2 * Math.PI) * Math.pow(t, n + 0.5) * Math.exp(-t) * x;\n}\n\nfunction stringOrArrayLength(s) {\n  if (Array.isArray(s)) {\n    return s.length;\n  }\n  return String(s).length;\n}\n\nfunction hypot() {\n  var sum = 0;\n  var larg = 0;\n  for (var i = 0; i < arguments.length; i++) {\n    var arg = Math.abs(arguments[i]);\n    var div;\n    if (larg < arg) {\n      div = larg / arg;\n      sum = (sum * div * div) + 1;\n      larg = arg;\n    } else if (arg > 0) {\n      div = arg / larg;\n      sum += div * div;\n    } else {\n      sum += arg;\n    }\n  }\n  return larg === Infinity ? Infinity : larg * Math.sqrt(sum);\n}\n\nfunction condition(cond, yep, nope) {\n  return cond ? yep : nope;\n}\n\n/**\n* Decimal adjustment of a number.\n* From @escopecz.\n*\n* @param {Number} value The number.\n* @param {Integer} exp  The exponent (the 10 logarithm of the adjustment base).\n* @return {Number} The adjusted value.\n*/\nfunction roundTo(value, exp) {\n  // If the exp is undefined or zero...\n  if (typeof exp === 'undefined' || +exp === 0) {\n    return Math.round(value);\n  }\n  value = +value;\n  exp = -(+exp);\n  // If the value is not a number or the exp is not an integer...\n  if (isNaN(value) || !(typeof exp === 'number' && exp % 1 === 0)) {\n    return NaN;\n  }\n  // Shift\n  value = value.toString().split('e');\n  value = Math.round(+(value[0] + 'e' + (value[1] ? (+value[1] - exp) : -exp)));\n  // Shift back\n  value = value.toString().split('e');\n  return +(value[0] + 'e' + (value[1] ? (+value[1] + exp) : exp));\n}\n\nfunction setVar(name, value, variables) {\n  if (variables) variables[name] = value;\n  return value;\n}\n\nfunction arrayIndex(array, index) {\n  return array[index | 0];\n}\n\nfunction max(array) {\n  if (arguments.length === 1 && Array.isArray(array)) {\n    return Math.max.apply(Math, array);\n  } else {\n    return Math.max.apply(Math, arguments);\n  }\n}\n\nfunction min(array) {\n  if (arguments.length === 1 && Array.isArray(array)) {\n    return Math.min.apply(Math, array);\n  } else {\n    return Math.min.apply(Math, arguments);\n  }\n}\n\nfunction arrayMap(f, a) {\n  if (typeof f !== 'function') {\n    throw new Error('First argument to map is not a function');\n  }\n  if (!Array.isArray(a)) {\n    throw new Error('Second argument to map is not an array');\n  }\n  return a.map(function (x, i) {\n    return f(x, i);\n  });\n}\n\nfunction arrayFold(f, init, a) {\n  if (typeof f !== 'function') {\n    throw new Error('First argument to fold is not a function');\n  }\n  if (!Array.isArray(a)) {\n    throw new Error('Second argument to fold is not an array');\n  }\n  return a.reduce(function (acc, x, i) {\n    return f(acc, x, i);\n  }, init);\n}\n\nfunction arrayFilter(f, a) {\n  if (typeof f !== 'function') {\n    throw new Error('First argument to filter is not a function');\n  }\n  if (!Array.isArray(a)) {\n    throw new Error('Second argument to filter is not an array');\n  }\n  return a.filter(function (x, i) {\n    return f(x, i);\n  });\n}\n\nfunction stringOrArrayIndexOf(target, s) {\n  if (!(Array.isArray(s) || typeof s === 'string')) {\n    throw new Error('Second argument to indexOf is not a string or array');\n  }\n\n  return s.indexOf(target);\n}\n\nfunction arrayJoin(sep, a) {\n  if (!Array.isArray(a)) {\n    throw new Error('Second argument to join is not an array');\n  }\n\n  return a.join(sep);\n}\n\nfunction sign(x) {\n  return ((x > 0) - (x < 0)) || +x;\n}\n\nvar ONE_THIRD = 1/3;\nfunction cbrt(x) {\n  return x < 0 ? -Math.pow(-x, ONE_THIRD) : Math.pow(x, ONE_THIRD);\n}\n\nfunction expm1(x) {\n  return Math.exp(x) - 1;\n}\n\nfunction log1p(x) {\n  return Math.log(1 + x);\n}\n\nfunction log2(x) {\n  return Math.log(x) / Math.LN2;\n}\n\nfunction Parser(options) {\n  this.options = options || {};\n  this.unaryOps = {\n    sin: Math.sin,\n    cos: Math.cos,\n    tan: Math.tan,\n    asin: Math.asin,\n    acos: Math.acos,\n    atan: Math.atan,\n    sinh: Math.sinh || sinh,\n    cosh: Math.cosh || cosh,\n    tanh: Math.tanh || tanh,\n    asinh: Math.asinh || asinh,\n    acosh: Math.acosh || acosh,\n    atanh: Math.atanh || atanh,\n    sqrt: Math.sqrt,\n    cbrt: Math.cbrt || cbrt,\n    log: Math.log,\n    log2: Math.log2 || log2,\n    ln: Math.log,\n    lg: Math.log10 || log10,\n    log10: Math.log10 || log10,\n    expm1: Math.expm1 || expm1,\n    log1p: Math.log1p || log1p,\n    abs: Math.abs,\n    ceil: Math.ceil,\n    floor: Math.floor,\n    round: Math.round,\n    trunc: Math.trunc || trunc,\n    '-': neg,\n    '+': Number,\n    exp: Math.exp,\n    not: not,\n    length: stringOrArrayLength,\n    '!': factorial,\n    sign: Math.sign || sign\n  };\n\n  this.binaryOps = {\n    '+': add,\n    '-': sub,\n    '*': mul,\n    '/': div,\n    '%': mod,\n    '^': Math.pow,\n    '||': concat,\n    '==': equal,\n    '!=': notEqual,\n    '>': greaterThan,\n    '<': lessThan,\n    '>=': greaterThanEqual,\n    '<=': lessThanEqual,\n    and: andOperator,\n    or: orOperator,\n    'in': inOperator,\n    '=': setVar,\n    '[': arrayIndex\n  };\n\n  this.ternaryOps = {\n    '?': condition\n  };\n\n  this.functions = {\n    random: random,\n    fac: factorial,\n    min: min,\n    max: max,\n    hypot: Math.hypot || hypot,\n    pyt: Math.hypot || hypot, // backward compat\n    pow: Math.pow,\n    atan2: Math.atan2,\n    'if': condition,\n    gamma: gamma,\n    roundTo: roundTo,\n    map: arrayMap,\n    fold: arrayFold,\n    filter: arrayFilter,\n    indexOf: stringOrArrayIndexOf,\n    join: arrayJoin\n  };\n\n  this.consts = {\n    E: Math.E,\n    PI: Math.PI,\n    'true': true,\n    'false': false\n  };\n}\n\nParser.prototype.parse = function (expr) {\n  var instr = [];\n  var parserState = new ParserState(\n    this,\n    new TokenStream(this, expr),\n    { allowMemberAccess: this.options.allowMemberAccess }\n  );\n\n  parserState.parseExpression(instr);\n  parserState.expect(TEOF, 'EOF');\n\n  return new Expression(instr, this);\n};\n\nParser.prototype.evaluate = function (expr, variables) {\n  return this.parse(expr).evaluate(variables);\n};\n\nvar sharedParser = new Parser();\n\nParser.parse = function (expr) {\n  return sharedParser.parse(expr);\n};\n\nParser.evaluate = function (expr, variables) {\n  return sharedParser.parse(expr).evaluate(variables);\n};\n\nvar optionNameMap = {\n  '+': 'add',\n  '-': 'subtract',\n  '*': 'multiply',\n  '/': 'divide',\n  '%': 'remainder',\n  '^': 'power',\n  '!': 'factorial',\n  '<': 'comparison',\n  '>': 'comparison',\n  '<=': 'comparison',\n  '>=': 'comparison',\n  '==': 'comparison',\n  '!=': 'comparison',\n  '||': 'concatenate',\n  'and': 'logical',\n  'or': 'logical',\n  'not': 'logical',\n  '?': 'conditional',\n  ':': 'conditional',\n  '=': 'assignment',\n  '[': 'array',\n  '()=': 'fndef'\n};\n\nfunction getOptionName(op) {\n  return optionNameMap.hasOwnProperty(op) ? optionNameMap[op] : op;\n}\n\nParser.prototype.isOperatorEnabled = function (op) {\n  var optionName = getOptionName(op);\n  var operators = this.options.operators || {};\n\n  return !(optionName in operators) || !!operators[optionName];\n};\n\n/*!\n Based on ndef.parser, by Raphael Graf(r@undefined.ch)\n http://www.undefined.ch/mparser/index.html\n\n Ported to JavaScript and modified by Matthew Crumley (email@matthewcrumley.com, http://silentmatt.com/)\n\n You are free to use and modify this code in anyway you find useful. Please leave this comment in the code\n to acknowledge its original source. If you feel like it, I enjoy hearing about projects that use my code,\n but don't feel like you have to let me know or ask permission.\n*/\n\n// Backwards compatibility\nvar index = {\n  Parser: Parser,\n  Expression: Expression\n};\n\nexport default index;\nexport { Expression, Parser };\n", "import expression from \"expr-eval\";\nimport {setProperty} from \"dot-prop\";\n\n/**\n * Utility class\n */\nexport class U {\n\n    /**\n     * Return an HTML attribute string formatted as name=\"value\" (default)\n     * or name=value for use in html template tag\n     *\n     * @param {string} name\n     * @param {string|null} value\n     * @param {boolean} specialChars\n     * @returns {string}\n     */\n    static attrHTML(name, value, specialChars = true) {\n        if (value && specialChars) {\n            value = '\"' + value + '\"';\n        }\n        return value ? `${name}=${value}` : '';\n    }\n\n    /**\n     * Adds visual mark for required form fields\n     *\n     * @param {object} config\n     * @returns {string}\n     */\n    static requiredMark(config) {\n        return (!config.validation || config.validation.required !== false) ? ' *' : '';\n    }\n\n    /**\n     * Creates tooltip HTML\n     *\n     * @param {Object} config\n     * @returns {string}\n     */\n    static tooltipHint(config) {\n        if (!config.tooltip) {\n            return '';\n        }\n\n        return `<span class=\"tooltip tooltip-hint\" data-tooltip=\"${config.tooltip}\">!</span>`;\n    }\n\n    /**\n     * Creates modal hint button\n     *\n     * @param {Object} config\n     * @returns {HTMLElement}\n     */\n    static modalHint(config) {\n        if (!config.modal) {\n            return null;\n        }\n\n        const hint = document.createElement(\"span\");\n        hint.innerText = \"?\";\n        hint.classList.add(\"modal-hint\");\n        hint.dataset[\"modal\"] = config.modal;\n\n        hint.addEventListener('click', (e) => {\n            const modal = e.target.nextElementSibling;\n            modal.classList.add('is-active');\n            document.querySelector('html').classList.add('is-clipped');\n        });\n\n        return hint;\n}\n\n    /**\n     * Creates modal element with event handlers\n     *\n     * @param {Object} config\n     * @returns {null|HTMLDivElement}\n     */\n    static modal(config) {\n        if (!config.modal) {\n            return null;\n        }\n\n        const modal = document.createElement(\"div\");\n        modal.classList.add(\"modal\");\n\n        const backdrop = document.createElement(\"div\");\n        backdrop.classList.add(\"modal-background\");\n        backdrop.addEventListener(\"click\", (e) => {\n            this.#closeModal(e, modal);\n        });\n\n        const contentContainer = document.createElement(\"div\");\n        contentContainer.classList.add(\"modal-content\");\n\n        const content = document.createElement(\"div\");\n        content.classList.add(\"box\", \"content\");\n        content.innerHTML = config.modal;\n\n        contentContainer.appendChild(content);\n\n        const button = document.createElement(\"button\");\n        button.type = \"button\";\n        button.classList.add(\"modal-close\", \"is-large\");\n        button.addEventListener(\"click\", (e) => {\n            this.#closeModal(e, modal);\n        });\n\n        modal.appendChild(backdrop);\n        modal.appendChild(contentContainer);\n        modal.appendChild(button);\n\n        return modal;\n    }\n\n    /**\n     *\n     * @param {Event} e\n     * @param {HTMLElement} modal\n     */\n    static #closeModal(e, modal) {\n        e.preventDefault();\n        modal.classList.remove(\"is-active\");\n        document.querySelector('html').classList.remove('is-clipped');\n    }\n\n    /**\n     * Attaches and renders children of the passed element\n     *\n     * @param {HTMLElement} parentElement\n     * @param {object} childrenConfig\n     * @param {State} state\n     */\n    static attachChildren(parentElement, childrenConfig, state) {\n        const parentName = parentElement.name ? parentElement.name + '.' : '';\n\n        // an additional wrapper is needed for Bulma columns\n        const columnWrapper = document.createElement('div');\n        columnWrapper.classList.add('columns', 'is-multiline');\n        parentElement.appendChild(columnWrapper);\n\n        Object.keys(childrenConfig).forEach(key => {\n            const fieldConfig = childrenConfig[key];\n            fieldConfig.name = `${parentName}${key}`; // add full dotted field ID to config\n            const element = document.createElement(`${fieldConfig.type}-component`);\n            element.initialize(state, fieldConfig);\n\n            columnWrapper.appendChild(element);\n            element.render(); // initial rendering\n        });\n    }\n\n    /**\n     * Attaches and renders children of the table parent\n     *\n     * @param {HTMLElement} parentElement\n     * @param {object} childrenConfig\n     * @param {State} state\n     * @param {number} repeat\n     */\n    static attachTableRows(parentElement, childrenConfig, state, repeat) {\n        const parentName = parentElement.name ? parentElement.name + '.' : '';\n\n        Object.keys(childrenConfig).forEach(key => {\n            const fieldConfig = childrenConfig[key];\n\n            const rowWrapper = document.createElement('tr');\n            const labelTh = document.createElement('th');\n            labelTh.innerText = fieldConfig.label;\n            rowWrapper.appendChild(labelTh);\n\n            for (let i = 0; i < repeat; i++) {\n                const idx = `${i + 1}`;\n                fieldConfig.name = `${parentName}${idx}.${key}`; // add full dotted field ID to config\n                const element = document.createElement(`${fieldConfig.type}-component`);\n                element.initialize(state, fieldConfig);\n\n                const fieldTd = document.createElement('td');\n                fieldTd.appendChild(element);\n\n                rowWrapper.appendChild(fieldTd);\n                element.render(); // initial rendering\n            }\n\n            parentElement.appendChild(rowWrapper);\n        });\n    }\n\n    static getTableColumnHeaders(label, repeat) {\n        const headers = [];\n        for (let i = 0; i <= repeat; i++) {\n            if (i === 0) {\n                headers.push('');\n            } else {\n                headers.push(`${label} ${i}`);\n            }\n        }\n        return headers;\n    }\n\n    /**\n     * Load field definitions from formconfig\n     * @returns {Object}\n     */\n    static loadFormConfig() {\n        return formconfig.form;\n    }\n\n    /**\n     * Returns the \"values\" object from form config supplied by backend\n     * @returns {Object}\n     */\n    static loadFormState() {\n        return formconfig.values || {};\n    }\n\n    /**\n     * Returns a string from the i18l dictionary provided by backend via formconfig\n     *\n     * @param {string} key\n     * @returns {string|null}\n     */\n    static getLang(key) {\n        return formconfig.lang[key] || null;\n    }\n\n    /**\n     * @param {string|null} visible\n     * @returns {expression.Expression}\n     */\n    static getParsedExpression(visible) {\n        if (!visible) {\n            return null;\n        }\n        try {\n            const parser = new expression.Parser({\n                operators: {\n                    logical: true,\n                    comparison: true,\n                    'in': true,\n                }\n            });\n\n            return parser.parse(visible);\n        } catch (e) {\n            console.error(`Error parsing visibility expression ${visible}`, e);\n        }\n\n    }\n\n    /**\n     * Evaluate expression against current form state\n     *\n     * @param {expression.Expression} expression\n     * @param {Object} state\n     * @returns {boolean}\n     */\n    static conditionMatches(expression, state) {\n        try {\n            const vars = expression.variables({withMembers: true});\n\n            // create an object with the variables and their values\n            // initializes non-existing variables with null\n            // FIXME null doesn't work with 'in' operand\n            const data = {};\n            vars.forEach(v => {\n                setProperty(data, v, state.values[v]);\n            });\n\n            return !!expression.evaluate(data);\n        } catch (e) {\n            console.error('Error evaluating visibility expression', e);\n            return true; // on error, show the element\n        }\n\n    }\n}\n", "import morphdom from 'morphdom';\nimport {ComponentState} from \"../ComponentState\";\nimport {State} from \"../State\";\nimport {ValidatorError} from \"../ValidatorError\";\nimport {U} from \"../U\";\n\n/**\n * Base class for all form components\n */\nexport class BaseComponent extends HTMLElement {\n    /** @type {boolean} component has been initialized */\n    #isInitialized = false;\n    /** @type {ComponentState} The current state */\n    myState;\n    /** @type {object} The configuration for this component as defined in the main YAML/JSON */\n    config;\n    /** @type {string} The name of the field in the form data */\n    name;\n    /** @type {string|null} The current validation error message */\n    validationError = null;\n    /** @type {boolean} Is the component curently visible? */\n    visible = true;\n\n    /** @type {Array<function>} Validators for the component */\n    validators = [];\n\n    /** @type {expression.Expression|null} The parsed visibility expression */\n    #visibilityExpression = null;\n\n    // region lifecycle management\n\n    /**\n     * Constructor\n     */\n    constructor() {\n        if (new.target === BaseComponent) {\n            throw new TypeError('BaseComponent is abstract and cannot be instantiated directly');\n        }\n        super();\n\n        // necessary for unregistering event handler\n        // see https://stackoverflow.com/a/33386309\n        this.onStateValueChange = this.onStateValueChange.bind(this);\n    }\n\n    /**\n     * Initialize the component with the form data and field configuration\n     *\n     * Called from FormComponent before the component is added to the DOM\n     *\n     * @param {State} state The current state\n     * @param {object} fieldConfig The configuration for this component as defined in the main YAML/JSON\n     */\n    initialize(state, fieldConfig) {\n        this.myState = new ComponentState(state, fieldConfig.name);\n        this.config = fieldConfig;\n        this.name = fieldConfig.name;\n        this.classList.add('component');\n\n        if (this.config.visible) {\n            this.#visibilityExpression = U.getParsedExpression(this.config.visible);\n        }\n\n        this.#isInitialized = true;\n    }\n\n    /**\n     * Called when the component is added to the DOM\n     *\n     * Registers event listener for input events and state changes\n     */\n    connectedCallback() {\n        if (!this.#isInitialized) {\n            throw new Error('Component was not initialized before adding to DOM');\n        }\n\n        // make the component rerender on state changes\n        document.addEventListener(State.STATE_VALUE_CHANGE_EVENT, this.onStateValueChange);\n\n        // register the default state change handler\n        this.registerStateChangeHandler();\n    }\n\n    /**\n     * Called when the component is removed from the DOM\n     *\n     * Unregisters the event listener for state changes\n     */\n    disconnectedCallback() {\n        document.removeEventListener(State.STATE_VALUE_CHANGE_EVENT, this.onStateValueChange);\n    }\n\n    // endregion\n\n    // region rendering\n\n    /**\n     * Render the component\n     *\n     * The default implementation uses morphdom to update the component from the HTML returned by the html() method\n     */\n    render() {\n        this.handleConditionalVisibility();\n\n        // Empty and hide the component if it should not be visible\n        let html;\n        if (this.visible) {\n            this.restoreState(); // restore the state if the component is visible\n            html = this.htmlWrap(this.html());\n            this.style.display = '';\n        } else {\n            this.myState.clear(); // clear the state if the component is not visible\n            html = null;\n            this.style.display = 'none';\n        }\n\n        // we do not want the component be replaced by the HTML but its children.\n        // Morphdom's childrenOnly takes care of that, but this means we also need to wrap the new HTML in\n        // an element whose children will be used to replace the children of the component\n        const disposableWrapper = document.createElement('div');\n        if (html instanceof HTMLElement) {\n            disposableWrapper.appendChild(html);\n        }\n\n        morphdom(this, disposableWrapper, {childrenOnly: true});\n    }\n\n    /**\n     * @return {HTMLElement|string} The HTML representation of the component\n     */\n    html() {\n        const el = document.createElement('div');\n        el.innerText = 'Not implemented';\n        return el;\n    }\n\n    /**\n     * Wrap the given HTML in a div and apply Bulma and Error handling\n     *\n     * @param {HTMLElement|string} html\n     * @returns {HTMLDivElement}\n     */\n    htmlWrap(html) {\n        const wrapper = document.createElement('div');\n        wrapper.classList.add('column', this.config.column ?? 'is-full');\n\n        if (typeof html === 'string') {\n            wrapper.innerHTML = html;\n        } else {\n            wrapper.appendChild(html);\n        }\n\n        if (this.validationError) {\n            wrapper.classList.add('has-errors');\n            let errorElement = wrapper.querySelector('.help.is-danger');\n            if (!errorElement) {\n                errorElement = document.createElement('p');\n                errorElement.classList.add('help', 'is-danger');\n                wrapper.appendChild(errorElement);\n            }\n            errorElement.innerText = this.validationError;\n        }\n\n        return wrapper;\n    }\n\n\n    /**\n     * Restore the state of the component from an old state\n     *\n     * The default implementations should be fine for simple input components.\n     * Fields with variable data sets will want to check the old state against the current data set\n     * or simply not restore the state.\n     */\n    restoreState() {\n        this.myState.restore();\n    }\n\n    /**\n     * Checks if the component should be visible\n     *\n     * This uses the visible property of the component configuration and evaluates it as an expression.\n     * The default render method uses this to set the display style of the component.\n     *\n     */\n    handleConditionalVisibility() {\n        if (!this.#visibilityExpression) return;\n\n        this.visible = U.conditionMatches(this.#visibilityExpression, this.myState.state);\n    }\n\n    // endregion\n\n    // region validation\n\n    /**\n     * Execute validations on the component's state\n     *\n     * @throws {ValidatorError} If a validation fails\n     */\n    executeValidators() {\n        if (!this.visible) {\n            return;\n        }\n\n        if (\n            (!this.config.validation || this.config.validation.required !== false) &&\n            (this.myState.value === null || this.myState.value === '')\n        ) {\n            throw new ValidatorError(this.name, U.getLang(\"error_required\"));\n        }\n    }\n\n    /**\n     * Validate the component and rerender it\n     *\n     * @returns {boolean}\n     */\n    validate() {\n        try {\n            this.executeValidators();\n        } catch (e) {\n            if (e instanceof ValidatorError) {\n                this.validationError = e.message;\n                this.render();\n                return false;\n            }\n            throw e;\n        }\n\n        if (this.validationError) {\n            this.validationError = null;\n            this.render();\n        }\n\n        return true;\n    }\n\n    // endregion\n\n    // region event handling\n\n    /**\n     * Register a handler to update the state if the component is changed by the user\n     *\n     * Default implementation listens for input events and calls updateStateOnInput\n     */\n    registerStateChangeHandler() {\n        this.addEventListener('input', (e) => {\n            this.updateStateOnInput(e.target);\n            e.stopPropagation();\n        });\n    }\n\n    /**\n     * Default handler for the stateValueChanged event\n     *\n     * Should not be overwritten. Instead, implement shouldUpdate() to influence the update behavior\n     *\n     * @param {CustomEvent} e The stateValueChanged event\n     */\n    onStateValueChange(e) {\n        if (this.shouldUpdate(e.detail)) {\n            this.render();\n        }\n    }\n\n    /**\n     * Default implementation for updating the state of the component\n     *\n     * This is method is registered in registerStateChangeHandler() if that method has not been overwritten\n     *\n     * IMPORTANT: state changes should always be atomic, i.e. the state should be updated in one go.\n     *\n     * @param {HTMLInputElement|HTMLTextAreaElement} target\n     */\n    updateStateOnInput(target) {\n        this.myState.value = target.value;\n    }\n\n    /**\n     * Should the component update for this change?\n     *\n     * Default implementation will only update when the field that changed is a dependency used in\n     * checking visibility.\n     *\n     * @param {StateValueChangeDetail} detail The details passed in the StateValueChangeEvent event\n     * @returns {boolean}\n     */\n    shouldUpdate(detail) {\n        if (!this.#visibilityExpression) return false;\n        const vars = this.#visibilityExpression.variables({withMembers: true});\n        return vars.includes(detail.name);\n    }\n\n    // endregion\n}\n", "import {BaseComponent} from './BaseComponent.js';\nimport {U} from \"../U\";\n\nexport class ChecklistComponent extends BaseComponent {\n\n    /** @override */\n    html() {\n        const checklist = document.createElement('div');\n        checklist.classList.add('field');\n\n        const label = document.createElement('label');\n        label.classList.add('label');\n        label.innerText = this.config.label + U.requiredMark(this.config);\n\n        checklist.appendChild(label);\n\n        const tooltip = U.tooltipHint(this.config);\n        checklist.insertAdjacentHTML('beforeend', tooltip);\n\n        const control = document.createElement('div');\n        control.classList.add('control');\n        checklist.appendChild(control);\n\n        for (const option of this.config.choices) {\n            control.insertAdjacentHTML(\"beforeend\", this.htmlCheckboxElement(option));\n        }\n\n        return checklist;\n    }\n\n    /**\n     * Create a single option.\n     *\n     * A string is required because HTMLElements are not indented and that\n     * breaks spacing in Bulma https://github.com/jgthms/bulma/issues/1049\n     *\n     * @param {string} optionLabel\n     * @returns {string}\n     */\n    htmlCheckboxElement(optionLabel) {\n        const checked = (this.myState.value && this.myState.value.has(optionLabel)) ? 'checked' : '';\n        return `\n            <label class=\"checkbox ${this.config.readonly ? 'readonly-choices' : ''}\">\n                <input type=\"checkbox\" name=\"${this.config.name}\" value=\"${optionLabel}\" ${checked} />\n                ${optionLabel}\n            </label>${(this.config.alignment && this.config.alignment === 'vertical') ? '<br>' : ''}\n        `;\n    }\n\n    /** @override */\n    updateStateOnInput(target) {\n        let state = this.myState.value || new Set();\n        if (!target.checked) {\n            state.delete(target.value);\n        } else {\n            state.add(target.value);\n        }\n        this.myState.value = state;\n    }\n}\n\ncustomElements.define('checklist-component', ChecklistComponent);\n", "var t={\"&\":\"&amp;\",\">\":\"&gt;\",\"<\":\"&lt;\",'\"':\"&quot;\",\"'\":\"&#39;\",\"`\":\"&#96;\"},e=new RegExp(Object.keys(t).join(\"|\"),\"g\");function n(n){return void 0===n&&(n=\"\"),String(n).replace(e,(function(e){return t[e]}))}export{n as default};\n", "/**\n * Map of HTML elements to allowed attributes.\n *\n * @type {Record<string, Array<string>>}\n */\nexport const htmlElementAttributes = {\n  '*': [\n    'accesskey',\n    'autocapitalize',\n    'autofocus',\n    'class',\n    'contenteditable',\n    'dir',\n    'draggable',\n    'enterkeyhint',\n    'hidden',\n    'id',\n    'inert',\n    'inputmode',\n    'is',\n    'itemid',\n    'itemprop',\n    'itemref',\n    'itemscope',\n    'itemtype',\n    'lang',\n    'nonce',\n    'popover',\n    'slot',\n    'spellcheck',\n    'style',\n    'tabindex',\n    'title',\n    'translate',\n    'writingsuggestions'\n  ],\n  a: [\n    'charset',\n    'coords',\n    'download',\n    'href',\n    'hreflang',\n    'name',\n    'ping',\n    'referrerpolicy',\n    'rel',\n    'rev',\n    'shape',\n    'target',\n    'type'\n  ],\n  applet: [\n    'align',\n    'alt',\n    'archive',\n    'code',\n    'codebase',\n    'height',\n    'hspace',\n    'name',\n    'object',\n    'vspace',\n    'width'\n  ],\n  area: [\n    'alt',\n    'coords',\n    'download',\n    'href',\n    'hreflang',\n    'nohref',\n    'ping',\n    'referrerpolicy',\n    'rel',\n    'shape',\n    'target',\n    'type'\n  ],\n  audio: [\n    'autoplay',\n    'controls',\n    'crossorigin',\n    'loop',\n    'muted',\n    'preload',\n    'src'\n  ],\n  base: ['href', 'target'],\n  basefont: ['color', 'face', 'size'],\n  blockquote: ['cite'],\n  body: ['alink', 'background', 'bgcolor', 'link', 'text', 'vlink'],\n  br: ['clear'],\n  button: [\n    'disabled',\n    'form',\n    'formaction',\n    'formenctype',\n    'formmethod',\n    'formnovalidate',\n    'formtarget',\n    'name',\n    'popovertarget',\n    'popovertargetaction',\n    'type',\n    'value'\n  ],\n  canvas: ['height', 'width'],\n  caption: ['align'],\n  col: ['align', 'char', 'charoff', 'span', 'valign', 'width'],\n  colgroup: ['align', 'char', 'charoff', 'span', 'valign', 'width'],\n  data: ['value'],\n  del: ['cite', 'datetime'],\n  details: ['name', 'open'],\n  dialog: ['open'],\n  dir: ['compact'],\n  div: ['align'],\n  dl: ['compact'],\n  embed: ['height', 'src', 'type', 'width'],\n  fieldset: ['disabled', 'form', 'name'],\n  font: ['color', 'face', 'size'],\n  form: [\n    'accept',\n    'accept-charset',\n    'action',\n    'autocomplete',\n    'enctype',\n    'method',\n    'name',\n    'novalidate',\n    'target'\n  ],\n  frame: [\n    'frameborder',\n    'longdesc',\n    'marginheight',\n    'marginwidth',\n    'name',\n    'noresize',\n    'scrolling',\n    'src'\n  ],\n  frameset: ['cols', 'rows'],\n  h1: ['align'],\n  h2: ['align'],\n  h3: ['align'],\n  h4: ['align'],\n  h5: ['align'],\n  h6: ['align'],\n  head: ['profile'],\n  hr: ['align', 'noshade', 'size', 'width'],\n  html: ['manifest', 'version'],\n  iframe: [\n    'align',\n    'allow',\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'allowusermedia',\n    'frameborder',\n    'height',\n    'loading',\n    'longdesc',\n    'marginheight',\n    'marginwidth',\n    'name',\n    'referrerpolicy',\n    'sandbox',\n    'scrolling',\n    'src',\n    'srcdoc',\n    'width'\n  ],\n  img: [\n    'align',\n    'alt',\n    'border',\n    'crossorigin',\n    'decoding',\n    'fetchpriority',\n    'height',\n    'hspace',\n    'ismap',\n    'loading',\n    'longdesc',\n    'name',\n    'referrerpolicy',\n    'sizes',\n    'src',\n    'srcset',\n    'usemap',\n    'vspace',\n    'width'\n  ],\n  input: [\n    'accept',\n    'align',\n    'alt',\n    'autocomplete',\n    'checked',\n    'dirname',\n    'disabled',\n    'form',\n    'formaction',\n    'formenctype',\n    'formmethod',\n    'formnovalidate',\n    'formtarget',\n    'height',\n    'ismap',\n    'list',\n    'max',\n    'maxlength',\n    'min',\n    'minlength',\n    'multiple',\n    'name',\n    'pattern',\n    'placeholder',\n    'popovertarget',\n    'popovertargetaction',\n    'readonly',\n    'required',\n    'size',\n    'src',\n    'step',\n    'type',\n    'usemap',\n    'value',\n    'width'\n  ],\n  ins: ['cite', 'datetime'],\n  isindex: ['prompt'],\n  label: ['for', 'form'],\n  legend: ['align'],\n  li: ['type', 'value'],\n  link: [\n    'as',\n    'blocking',\n    'charset',\n    'color',\n    'crossorigin',\n    'disabled',\n    'fetchpriority',\n    'href',\n    'hreflang',\n    'imagesizes',\n    'imagesrcset',\n    'integrity',\n    'media',\n    'referrerpolicy',\n    'rel',\n    'rev',\n    'sizes',\n    'target',\n    'type'\n  ],\n  map: ['name'],\n  menu: ['compact'],\n  meta: ['charset', 'content', 'http-equiv', 'media', 'name', 'scheme'],\n  meter: ['high', 'low', 'max', 'min', 'optimum', 'value'],\n  object: [\n    'align',\n    'archive',\n    'border',\n    'classid',\n    'codebase',\n    'codetype',\n    'data',\n    'declare',\n    'form',\n    'height',\n    'hspace',\n    'name',\n    'standby',\n    'type',\n    'typemustmatch',\n    'usemap',\n    'vspace',\n    'width'\n  ],\n  ol: ['compact', 'reversed', 'start', 'type'],\n  optgroup: ['disabled', 'label'],\n  option: ['disabled', 'label', 'selected', 'value'],\n  output: ['for', 'form', 'name'],\n  p: ['align'],\n  param: ['name', 'type', 'value', 'valuetype'],\n  pre: ['width'],\n  progress: ['max', 'value'],\n  q: ['cite'],\n  script: [\n    'async',\n    'blocking',\n    'charset',\n    'crossorigin',\n    'defer',\n    'fetchpriority',\n    'integrity',\n    'language',\n    'nomodule',\n    'referrerpolicy',\n    'src',\n    'type'\n  ],\n  select: [\n    'autocomplete',\n    'disabled',\n    'form',\n    'multiple',\n    'name',\n    'required',\n    'size'\n  ],\n  slot: ['name'],\n  source: ['height', 'media', 'sizes', 'src', 'srcset', 'type', 'width'],\n  style: ['blocking', 'media', 'type'],\n  table: [\n    'align',\n    'bgcolor',\n    'border',\n    'cellpadding',\n    'cellspacing',\n    'frame',\n    'rules',\n    'summary',\n    'width'\n  ],\n  tbody: ['align', 'char', 'charoff', 'valign'],\n  td: [\n    'abbr',\n    'align',\n    'axis',\n    'bgcolor',\n    'char',\n    'charoff',\n    'colspan',\n    'headers',\n    'height',\n    'nowrap',\n    'rowspan',\n    'scope',\n    'valign',\n    'width'\n  ],\n  template: [\n    'shadowrootclonable',\n    'shadowrootdelegatesfocus',\n    'shadowrootmode'\n  ],\n  textarea: [\n    'autocomplete',\n    'cols',\n    'dirname',\n    'disabled',\n    'form',\n    'maxlength',\n    'minlength',\n    'name',\n    'placeholder',\n    'readonly',\n    'required',\n    'rows',\n    'wrap'\n  ],\n  tfoot: ['align', 'char', 'charoff', 'valign'],\n  th: [\n    'abbr',\n    'align',\n    'axis',\n    'bgcolor',\n    'char',\n    'charoff',\n    'colspan',\n    'headers',\n    'height',\n    'nowrap',\n    'rowspan',\n    'scope',\n    'valign',\n    'width'\n  ],\n  thead: ['align', 'char', 'charoff', 'valign'],\n  time: ['datetime'],\n  tr: ['align', 'bgcolor', 'char', 'charoff', 'valign'],\n  track: ['default', 'kind', 'label', 'src', 'srclang'],\n  ul: ['compact', 'type'],\n  video: [\n    'autoplay',\n    'controls',\n    'crossorigin',\n    'height',\n    'loop',\n    'muted',\n    'playsinline',\n    'poster',\n    'preload',\n    'src',\n    'width'\n  ]\n}\n", "import t from\"html-es6cape\";import{htmlElementAttributes as e}from\"html-element-attributes\";var r=Object.values(e).flat();function n(t){return r.some((function(e){return t.endsWith(\"\".concat(e,\"=\"))}))}var a=[\"action\",\"archive\",\"background\",\"cite\",\"classid\",\"codebase\",\"content\",\"data\",\"dynsrc\",\"formaction\",\"href\",\"icon\",\"imagesrcset\",\"longdesc\",\"lowsrc\",\"manifest\",\"nohref\",\"onload\",\"poster\",\"popovertargetaction\",\"profile\",\"src\",\"srcset\",\"style\",\"usemap\"],o=function(t){return a.some((function(e){return t.endsWith(\"\".concat(e,\"=\"))||t.endsWith(\"\".concat(e,'=\"'))}))};function i(e){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];return e.raw.reduce((function(a,i,c){var s=r[c-1];return Array.isArray(s)?s=s.join(\"\"):e.raw[c-1]&&e.raw[c-1].endsWith(\"$\")?a=a.slice(0,-1):s=t(s),n(a)&&(a+='\"',i='\"'+i),o(a)&&(console.warn(\"[html-template-tag] Trying to interpolate inside an URI attribute. This can lead to security vulnerabilities. The interpolation has been removed.\",{acc:a,subst:s,lit:i}),s=\"\"),a+s+i}))}export{i as default};\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\nimport {U} from '../U.js';\n\nexport class DateComponent extends BaseComponent {\n\n    html() {\n        return html`\n            <div class=\"field\">\n                <label class=\"label\">${this.config.label}${U.requiredMark(this.config)}</label>$${U.tooltipHint(this.config)}\n                <div class=\"control\">\n                    <input class=\"input\"\n                           ${U.attrHTML('placeholder', this.config.placeholder, false)}\n                           type=\"date\" name=\"${this.name}\" value=\"${this.myState.value ?? ''}\"\n                           ${this.config.readonly ? 'readonly' : ''}>\n                </div>\n            </div>\n        `;\n    }\n}\n\ncustomElements.define('date-component', DateComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\nimport {U} from '../U.js';\n\nexport class DatetimeComponent extends BaseComponent {\n\n    html() {\n        return html`\n            <div class=\"field\">\n                <label class=\"label\">${this.config.label}${U.requiredMark(this.config)}</label>$${U.tooltipHint(this.config)}\n                <div class=\"control\">\n                    <input\n                            ${U.attrHTML('placeholder', this.config.placeholder, false)}\n                            class=\"input\" type=\"datetime-local\" name=\"${this.name}\" value=\"${this.myState.value ?? ''}\"\n                            ${this.config.readonly ? 'readonly' : ''}>\n                </div>\n            </div>\n        `;\n    }\n}\n\ncustomElements.define('datetime-component', DatetimeComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\n\nexport class DownloadComponent extends BaseComponent {\n\n    html() {\n        return html`\n            <div class=\"field\">\n                <div class=\"control\">\n                    FIXME download\n                </div>\n            </div>\n        `;\n    }\n\n    executeValidators() {\n        return true;\n    }\n}\n\ncustomElements.define('download-component', DownloadComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport {U} from '../U.js';\n\nexport class DropdownComponent extends BaseComponent {\n\n    /** @type {[expression.Expression]|Array} Parsed expressions for conditional options */\n    optionsExpressions = [];\n\n    initialize(state, fieldConfig) {\n        super.initialize(state, fieldConfig);\n        this.optionsExpressions = this.getOptionsExpressions();\n    }\n\n    html() {\n        const select = document.createElement('select');\n        select.name = this.config.name;\n        if (this.config.multiselect) {\n            select.multiple = true;\n        }\n        if (this.config.size) {\n            select.size = this.config.size;\n        }\n\n        if (this.config.readonly) {\n            select.classList.add('readonly-select');\n        }\n\n        if (!this.config.multiselect && this.config.empty_label) {\n            const option = document.createElement('option');\n            option.value = '';\n            option.innerText = this.config.empty_label;\n            select.appendChild(option);\n        }\n\n        const availableChoices = this.#getAvailableChoices();\n\n        for (const optionLabel of availableChoices) {\n            const option = document.createElement('option');\n            option.value = optionLabel;\n            option.innerText = optionLabel;\n            option.selected = select.multiple ? (this.myState.value && this.myState.value.has(optionLabel)) : (this.myState.value && this.myState.value === optionLabel);\n            select.appendChild(option);\n        }\n\n        const selectContainer = document.createElement('div');\n        selectContainer.classList.add('select');\n        if (this.config.multiselect) {\n            selectContainer.classList.add('is-multiple');\n        }\n        selectContainer.appendChild(select);\n\n        const control = document.createElement('div');\n        control.classList.add('control');\n\n        control.appendChild(selectContainer);\n\n        const field = document.createElement('div');\n        field.classList.add('field');\n\n        const label = document.createElement('label');\n        label.classList.add('label');\n        label.innerText = this.config.label + U.requiredMark(this.config);\n\n        field.appendChild(label);\n        const tooltip = U.tooltipHint(this.config);\n        field.insertAdjacentHTML('beforeend', tooltip);\n\n        field.appendChild(control);\n\n        return field;\n    }\n\n    /** @override */\n    updateStateOnInput(target) {\n        // null state when empty / placeholder option has been selected\n        if (target.value === '') {\n            this.myState.value = null;\n            return;\n        }\n\n        // no need to override further in single-select field\n        if (!this.config.multiselect) {\n            return super.updateStateOnInput(target);\n        }\n\n        let state = this.myState.value || new Set();\n\n        // FIXME handle removal of last option (only click event is fired)\n        if (state.has(target.value)) {\n            state.delete(target.value);\n        } else {\n            state.add(target.value);\n        }\n        this.myState.value = state;\n    }\n\n    /**\n     * Evaluate all dependencies of options\n     *\n     * @param {StateValueChangeDetail} detail\n     * @returns {boolean}\n     */\n    shouldUpdate(detail) {\n\n        if (!this.config.conditional_choices || !this.optionsExpressions.length) {\n            return false;\n        }\n\n        const vars = [];\n        for (const expr of this.optionsExpressions) {\n            vars.push(... expr.variables({withMembers: true}));\n        }\n\n        return vars.includes(detail.name);\n    }\n\n    /**\n     * Clear state when options change to remove potentially invalid choices\n     *\n     * @override\n     */\n    restoreState() {\n        this.myState.clear();\n    }\n\n    /**\n     * Collects conditional expressions attached to options,\n     * which will be evaluated in shouldUpdate()\n     *\n     * @returns {*[]}\n     */\n    getOptionsExpressions() {\n        const expressions= [];\n        if (!this.config.conditional_choices) {\n            return expressions;\n        }\n\n        for (const set of this.config.conditional_choices) {\n            expressions.push(U.getParsedExpression(set.visible));\n        }\n\n        return expressions.filter((expr) => { return expr; });\n    }\n\n    /**\n     * Get choices that satisfy defined visibility conditions\n     *\n     * @returns {Set}\n     */\n    #getAvailableChoices() {\n        if (this.config.choices) {\n            return new Set(this.config.choices);\n        }\n\n        if (this.config.conditional_choices) {\n            const filtered = this.config.conditional_choices.filter(set => {\n                if (!set.visible) {\n                    return true;\n                }\n                const expr = U.getParsedExpression(set.visible);\n                return U.conditionMatches(expr, this.myState.state);\n            });\n\n            const flattened = filtered.map((ch) => {\n                return ch.choices\n            }).flat();\n\n            // remove duplicates\n            return new Set(flattened);\n        }\n\n        return new Set();\n    }\n\n}\n\ncustomElements.define('dropdown-component', DropdownComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\nimport {U} from '../U.js';\n\nexport class EmailComponent extends BaseComponent {\n    html() {\n        return html`\n            <div class=\"field\">\n                <label class=\"label\">${this.config.label}${U.requiredMark(this.config)}</label>$${U.tooltipHint(this.config)}\n                <div class=\"control\">\n                    <input class=\"input\" type=\"email\" name=\"${this.name}\"\n                           ${U.attrHTML('placeholder', this.config.placeholder, false)}\n                           value=\"${this.myState.value ?? ''}\"\n                           ${this.config.readonly ? 'readonly' : ''}>\n                </div>\n            </div>\n        `;\n    }\n}\n\ncustomElements.define('email-component', EmailComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport {U} from '../U.js';\n\nexport class FieldsetComponent extends BaseComponent {\n    html() {\n        const fieldSetElement = document.createElement('fieldset');\n        // fieldsets need a name for building full dotted paths\n        fieldSetElement.name = this.config.name;\n        fieldSetElement.classList.add('box');\n\n        if (this.config.label) {\n            fieldSetElement.insertAdjacentHTML('afterbegin', `<legend>${this.config.label}</legend>`);\n        }\n\n        U.attachChildren(fieldSetElement, this.config['children'], this.myState.state);\n\n        return fieldSetElement;\n    }\n\n\n    executeValidators() {\n        return true;\n    }\n}\n\ncustomElements.define('fieldset-component', FieldsetComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\n\nexport class HiddenComponent extends BaseComponent {\n\n    html() {\n        return html`\n            <input type=\"hidden\" name=\"${this.config.name}\" value=\"${this.myState.value}\" />\n        `;\n    }\n\n    executeValidators() {\n        return true;\n    }\n}\n\ncustomElements.define('hidden-component', HiddenComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\n\nexport class HrComponent extends BaseComponent {\n\n    html() {\n        return html`\n            <hr style=\"background-color: ${this.config.color ?? 'silver'} height: ${this.config.height ?? 1}px;\">\n        `;\n    }\n\n    executeValidators() {\n        return true;\n    }\n}\n\ncustomElements.define('hr-component', HrComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\n\nexport class ImageComponent extends BaseComponent {\n\n    html() {\n        return html`\n            <div class=\"field\">\n                <div class=\"control\">\n                    FIXME image\n                </div>\n            </div>\n        `;\n    }\n\n    executeValidators() {\n        return true;\n    }\n}\n\ncustomElements.define('image-component', ImageComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\n\nexport class MarkdownComponent extends BaseComponent {\n\n    html() {\n        return html`\n            <div class=\"field\">\n                <div class=\"control\">\n                    ${this.config.markdown}\n                </div>\n            </div>\n        `;\n    }\n\n    executeValidators() {\n        return true;\n    }\n}\n\ncustomElements.define('markdown-component', MarkdownComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\nimport {U} from '../U.js';\nimport {ValidatorError} from \"../ValidatorError\";\n\nexport class NumberinputComponent extends BaseComponent {\n\n    html() {\n        return html`\n            <div class=\"field\">\n                <label class=\"label\">${this.config.label}${U.requiredMark(this.config)}</label>$${U.tooltipHint(this.config)}\n                <div class=\"control\">\n                    <input class=\"input\" type=\"number\" step=\"1\" \n                           name=\"${this.name}\" value=\"${this.myState.value ?? ''}\"\n                           ${this.config.readonly ? 'readonly' : ''}>\n                </div>\n            </div>\n        `;\n    }\n\n    /**\n     * Handle \"min\" and \"max\" validation\n     */\n    executeValidators() {\n        super.executeValidators();\n\n        if (\n            this.config.validation && this.config.validation.min && this.myState.value &&\n            this.myState.value < this.config.validation.min\n        ) {\n            throw new ValidatorError(this.name, `${U.getLang(\"error_min\")} ${this.config.validation.min}`);\n        }\n\n        if (\n            this.config.validation && this.config.validation.max && this.myState.value &&\n            this.myState.value > this.config.validation.max\n        ) {\n            throw new ValidatorError(this.name, `${U.getLang(\"error_max\")} ${this.config.validation.max}`);\n        }\n    }\n}\n\ncustomElements.define('numberinput-component', NumberinputComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport {U} from '../U.js';\n\nexport class RadiosetComponent extends BaseComponent {\n\n    /** @override */\n    html() {\n        const radioset = document.createElement('div');\n        radioset.classList.add('field');\n\n        const label = document.createElement('label');\n        label.classList.add('label');\n        label.innerText = this.config.label + U.requiredMark(this.config);\n        radioset.appendChild(label);\n\n        const tooltip = U.tooltipHint(this.config);\n        radioset.insertAdjacentHTML('beforeend', tooltip);\n\n        const control = document.createElement('div');\n        control.classList.add('control');\n        radioset.appendChild(control);\n\n        for (const option of this.config.choices) {\n            control.insertAdjacentHTML(\"beforeend\", this.htmlRadioElement(option));\n        }\n\n        return radioset;\n    }\n\n    /**\n     * Create a single option\n     *\n     * A string is required because HTMLElements are not indented and that\n     * breaks spacing in Bulma https://github.com/jgthms/bulma/issues/1049\n     *\n     * @param {string} optionLabel\n     * @returns {string}\n     */\n    htmlRadioElement(optionLabel) {\n        const checked = (this.myState.value === optionLabel) ? 'checked' : '';\n        return `\n            <label class=\"radio ${this.config.readonly ? 'readonly-choices' : ''}\">\n                <input type=\"radio\" name=\"${this.config.name}\" value=\"${optionLabel}\"\n                    ${checked} />\n                ${optionLabel}\n            </label>${(this.config.alignment && this.config.alignment === 'vertical') ? '<br>' : ''}\n        `;\n    }\n}\n\ncustomElements.define('radioset-component', RadiosetComponent);\n", "// Interface for point data structure used e.g. in SignaturePad#fromData method\nexport interface BasicPoint {\n  x: number;\n  y: number;\n  pressure: number;\n  time: number;\n}\n\nexport class Point implements BasicPoint {\n  public x: number;\n  public y: number;\n  public pressure: number;\n  public time: number;\n\n  constructor(x: number, y: number, pressure?: number, time?: number) {\n    if (isNaN(x) || isNaN(y)) {\n      throw new Error(`Point is invalid: (${x}, ${y})`);\n    }\n    this.x = +x;\n    this.y = +y;\n    this.pressure = pressure || 0;\n    this.time = time || Date.now();\n  }\n\n  public distanceTo(start: BasicPoint): number {\n    return Math.sqrt(\n      Math.pow(this.x - start.x, 2) + Math.pow(this.y - start.y, 2),\n    );\n  }\n\n  public equals(other: BasicPoint): boolean {\n    return (\n      this.x === other.x &&\n      this.y === other.y &&\n      this.pressure === other.pressure &&\n      this.time === other.time\n    );\n  }\n\n  public velocityFrom(start: BasicPoint): number {\n    return this.time !== start.time\n      ? this.distanceTo(start) / (this.time - start.time)\n      : 0;\n  }\n}\n", "import { BasicPoint, Point } from './point';\n\nexport class Bezier {\n  public static fromPoints(\n    points: Point[],\n    widths: { start: number; end: number },\n  ): Bezier {\n    const c2 = this.calculateControlPoints(points[0], points[1], points[2]).c2;\n    const c3 = this.calculateControlPoints(points[1], points[2], points[3]).c1;\n\n    return new Bezier(points[1], c2, c3, points[2], widths.start, widths.end);\n  }\n\n  private static calculateControlPoints(\n    s1: BasicPoint,\n    s2: BasicPoint,\n    s3: BasicPoint,\n  ): {\n    c1: BasicPoint;\n    c2: BasicPoint;\n  } {\n    const dx1 = s1.x - s2.x;\n    const dy1 = s1.y - s2.y;\n    const dx2 = s2.x - s3.x;\n    const dy2 = s2.y - s3.y;\n\n    const m1 = { x: (s1.x + s2.x) / 2.0, y: (s1.y + s2.y) / 2.0 };\n    const m2 = { x: (s2.x + s3.x) / 2.0, y: (s2.y + s3.y) / 2.0 };\n\n    const l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n    const l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\n\n    const dxm = m1.x - m2.x;\n    const dym = m1.y - m2.y;\n\n    const k = l1 + l2 == 0 ? 0 : l2 / (l1 + l2);\n    const cm = { x: m2.x + dxm * k, y: m2.y + dym * k };\n\n    const tx = s2.x - cm.x;\n    const ty = s2.y - cm.y;\n\n    return {\n      c1: new Point(m1.x + tx, m1.y + ty),\n      c2: new Point(m2.x + tx, m2.y + ty),\n    };\n  }\n\n  constructor(\n    public startPoint: Point,\n    public control2: BasicPoint,\n    public control1: BasicPoint,\n    public endPoint: Point,\n    public startWidth: number,\n    public endWidth: number,\n  ) {}\n\n  // Returns approximated length. Code taken from https://www.lemoda.net/maths/bezier-length/index.html.\n  public length(): number {\n    const steps = 10;\n    let length = 0;\n    let px;\n    let py;\n\n    for (let i = 0; i <= steps; i += 1) {\n      const t = i / steps;\n      const cx = this.point(\n        t,\n        this.startPoint.x,\n        this.control1.x,\n        this.control2.x,\n        this.endPoint.x,\n      );\n      const cy = this.point(\n        t,\n        this.startPoint.y,\n        this.control1.y,\n        this.control2.y,\n        this.endPoint.y,\n      );\n\n      if (i > 0) {\n        const xdiff = cx - (px as number);\n        const ydiff = cy - (py as number);\n\n        length += Math.sqrt(xdiff * xdiff + ydiff * ydiff);\n      }\n\n      px = cx;\n      py = cy;\n    }\n\n    return length;\n  }\n\n  // Calculate parametric value of x or y given t and the four point coordinates of a cubic bezier curve.\n  private point(\n    t: number,\n    start: number,\n    c1: number,\n    c2: number,\n    end: number,\n  ): number {\n    // prettier-ignore\n    return (       start * (1.0 - t) * (1.0 - t)  * (1.0 - t))\n         + (3.0 *  c1    * (1.0 - t) * (1.0 - t)  * t)\n         + (3.0 *  c2    * (1.0 - t) * t          * t)\n         + (       end   * t         * t          * t);\n  }\n}\n", "export class SignatureEventTarget {\n  /* tslint:disable: variable-name */\n  private _et: EventTarget;\n  /* tslint:enable: variable-name */\n\n  constructor() {\n    try {\n      this._et = new EventTarget();\n    } catch {\n      // Using document as EventTarget to support iOS 13 and older.\n      // Because EventTarget constructor just exists at iOS 14 and later.\n      this._et = document;\n    }\n  }\n\n  addEventListener(\n    type: string,\n    listener: EventListenerOrEventListenerObject | null,\n    options?: boolean | AddEventListenerOptions,\n  ): void {\n    this._et.addEventListener(type, listener, options);\n  }\n\n  dispatchEvent(event: Event): boolean {\n    return this._et.dispatchEvent(event);\n  }\n\n  removeEventListener(\n    type: string,\n    callback: EventListenerOrEventListenerObject | null,\n    options?: boolean | EventListenerOptions,\n  ): void {\n    this._et.removeEventListener(type, callback, options);\n  }\n}\n", "/* eslint-disable @typescript-eslint/no-explicit-any, @typescript-eslint/no-this-alias */\n// Slightly simplified version of http://stackoverflow.com/a/27078401/815507\n\nexport function throttle(\n  fn: (...args: any[]) => any,\n  wait = 250,\n): (this: any, ...args: any[]) => any {\n  let previous = 0;\n  let timeout: number | null = null;\n  let result: any;\n  let storedContext: any;\n  let storedArgs: any[];\n\n  const later = (): void => {\n    previous = Date.now();\n    timeout = null;\n    result = fn.apply(storedContext, storedArgs);\n\n    if (!timeout) {\n      storedContext = null;\n      storedArgs = [];\n    }\n  };\n\n  return function wrapper(this: any, ...args: any[]): any {\n    const now = Date.now();\n    const remaining = wait - (now - previous);\n\n    storedContext = this;\n    storedArgs = args;\n\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n\n      previous = now;\n      result = fn.apply(storedContext, storedArgs);\n\n      if (!timeout) {\n        storedContext = null;\n        storedArgs = [];\n      }\n    } else if (!timeout) {\n      timeout = window.setTimeout(later, remaining);\n    }\n\n    return result;\n  };\n}\n", "/**\n * The main idea and some parts of the code (e.g. drawing variable width Bzier curve) are taken from:\n * http://corner.squareup.com/2012/07/smoother-signatures.html\n *\n * Implementation of interpolation using cubic Bzier curves is taken from:\n * https://web.archive.org/web/20160323213433/http://www.benknowscode.com/2012/09/path-interpolation-using-cubic-bezier_9742.html\n *\n * Algorithm for approximated length of a Bzier curve is taken from:\n * http://www.lemoda.net/maths/bezier-length/index.html\n */\n\nimport { Bezier } from './bezier';\nimport { BasicPoint, Point } from './point';\nimport { SignatureEventTarget } from './signature_event_target';\nimport { throttle } from './throttle';\n\nexport interface SignatureEvent {\n  event: MouseEvent | TouchEvent | PointerEvent;\n  type: string;\n  x: number;\n  y: number;\n  pressure: number;\n}\n\nexport interface FromDataOptions {\n  clear?: boolean;\n}\n\nexport interface ToSVGOptions {\n  includeBackgroundColor?: boolean;\n}\n\nexport interface PointGroupOptions {\n  dotSize: number;\n  minWidth: number;\n  maxWidth: number;\n  penColor: string;\n  velocityFilterWeight: number;\n  /**\n   * This is the globalCompositeOperation for the line.\n   * *default: 'source-over'*\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation\n   */\n  compositeOperation: GlobalCompositeOperation;\n}\n\nexport interface Options extends Partial<PointGroupOptions> {\n  minDistance?: number;\n  backgroundColor?: string;\n  throttle?: number;\n  canvasContextOptions?: CanvasRenderingContext2DSettings;\n}\n\nexport interface PointGroup extends PointGroupOptions {\n  points: BasicPoint[];\n}\n\nexport default class SignaturePad extends SignatureEventTarget {\n  // Public stuff\n  public dotSize: number;\n  public minWidth: number;\n  public maxWidth: number;\n  public penColor: string;\n  public minDistance: number;\n  public velocityFilterWeight: number;\n  public compositeOperation: GlobalCompositeOperation;\n  public backgroundColor: string;\n  public throttle: number;\n  public canvasContextOptions: CanvasRenderingContext2DSettings;\n\n  // Private stuff\n  /* tslint:disable: variable-name */\n  private _ctx: CanvasRenderingContext2D;\n  private _drawingStroke = false;\n  private _isEmpty = true;\n  private _lastPoints: Point[] = []; // Stores up to 4 most recent points; used to generate a new curve\n  private _data: PointGroup[] = []; // Stores all points in groups (one group per line or dot)\n  private _lastVelocity = 0;\n  private _lastWidth = 0;\n  private _strokeMoveUpdate: (event: SignatureEvent) => void;\n  /* tslint:enable: variable-name */\n\n  constructor(\n    private canvas: HTMLCanvasElement,\n    options: Options = {},\n  ) {\n    super();\n    this.velocityFilterWeight = options.velocityFilterWeight || 0.7;\n    this.minWidth = options.minWidth || 0.5;\n    this.maxWidth = options.maxWidth || 2.5;\n\n    // We need to handle 0 value, so use `??` instead of `||`\n    this.throttle = options.throttle ?? 16; // in milliseconds\n    this.minDistance = options.minDistance ?? 5; // in pixels\n    this.dotSize = options.dotSize || 0;\n    this.penColor = options.penColor || 'black';\n    this.backgroundColor = options.backgroundColor || 'rgba(0,0,0,0)';\n    this.compositeOperation = options.compositeOperation || 'source-over';\n    this.canvasContextOptions = options.canvasContextOptions ?? {};\n\n    this._strokeMoveUpdate = this.throttle\n      ? throttle(SignaturePad.prototype._strokeUpdate, this.throttle)\n      : SignaturePad.prototype._strokeUpdate;\n    this._ctx = canvas.getContext(\n      '2d',\n      this.canvasContextOptions,\n    ) as CanvasRenderingContext2D;\n\n    this.clear();\n\n    // Enable mouse and touch event handlers\n    this.on();\n  }\n\n  public clear(): void {\n    const { _ctx: ctx, canvas } = this;\n\n    // Clear canvas using background color\n    ctx.fillStyle = this.backgroundColor;\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n    this._data = [];\n    this._reset(this._getPointGroupOptions());\n    this._isEmpty = true;\n  }\n\n  public fromDataURL(\n    dataUrl: string,\n    options: {\n      ratio?: number;\n      width?: number;\n      height?: number;\n      xOffset?: number;\n      yOffset?: number;\n    } = {},\n  ): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const image = new Image();\n      const ratio = options.ratio || window.devicePixelRatio || 1;\n      const width = options.width || this.canvas.width / ratio;\n      const height = options.height || this.canvas.height / ratio;\n      const xOffset = options.xOffset || 0;\n      const yOffset = options.yOffset || 0;\n\n      this._reset(this._getPointGroupOptions());\n\n      image.onload = (): void => {\n        this._ctx.drawImage(image, xOffset, yOffset, width, height);\n        resolve();\n      };\n      image.onerror = (error): void => {\n        reject(error);\n      };\n      image.crossOrigin = 'anonymous';\n      image.src = dataUrl;\n\n      this._isEmpty = false;\n    });\n  }\n\n  public toDataURL(\n    type: 'image/svg+xml',\n    encoderOptions?: ToSVGOptions,\n  ): string;\n  public toDataURL(type?: string, encoderOptions?: number): string;\n  public toDataURL(\n    type = 'image/png',\n    encoderOptions?: number | ToSVGOptions | undefined,\n  ): string {\n    switch (type) {\n      case 'image/svg+xml':\n        if (typeof encoderOptions !== 'object') {\n          encoderOptions = undefined;\n        }\n        return `data:image/svg+xml;base64,${btoa(\n          this.toSVG(encoderOptions as ToSVGOptions),\n        )}`;\n      default:\n        if (typeof encoderOptions !== 'number') {\n          encoderOptions = undefined;\n        }\n        return this.canvas.toDataURL(type, encoderOptions);\n    }\n  }\n\n  public on(): void {\n    // Disable panning/zooming when touching canvas element\n    this.canvas.style.touchAction = 'none';\n    (this.canvas.style as CSSStyleDeclaration & { msTouchAction: string | null }).msTouchAction = 'none';\n    this.canvas.style.userSelect = 'none';\n\n    const isIOS =\n      /Macintosh/.test(navigator.userAgent) && 'ontouchstart' in document;\n\n    // The \"Scribble\" feature of iOS intercepts point events. So that we can\n    // lose some of them when tapping rapidly. Use touch events for iOS\n    // platforms to prevent it. See\n    // https://developer.apple.com/forums/thread/664108 for more information.\n    if (window.PointerEvent && !isIOS) {\n      this._handlePointerEvents();\n    } else {\n      this._handleMouseEvents();\n\n      if ('ontouchstart' in window) {\n        this._handleTouchEvents();\n      }\n    }\n  }\n\n  public off(): void {\n    // Enable panning/zooming when touching canvas element\n    this.canvas.style.touchAction = 'auto';\n    (this.canvas.style as CSSStyleDeclaration & { msTouchAction: string | null }).msTouchAction = 'auto';\n    this.canvas.style.userSelect = 'auto';\n\n    this.canvas.removeEventListener('pointerdown', this._handlePointerDown);\n    this.canvas.removeEventListener('mousedown', this._handleMouseDown);\n    this.canvas.removeEventListener('touchstart', this._handleTouchStart);\n\n    this._removeMoveUpEventListeners();\n  }\n\n  private _getListenerFunctions() {\n    const canvasWindow =\n      window.document === this.canvas.ownerDocument\n        ? window\n        : this.canvas.ownerDocument.defaultView ?? this.canvas.ownerDocument;\n\n    return {\n      addEventListener: canvasWindow.addEventListener.bind(\n        canvasWindow,\n      ) as typeof window.addEventListener,\n      removeEventListener: canvasWindow.removeEventListener.bind(\n        canvasWindow,\n      ) as typeof window.removeEventListener,\n    };\n  }\n\n  private _removeMoveUpEventListeners(): void {\n    const { removeEventListener } = this._getListenerFunctions();\n    removeEventListener('pointermove', this._handlePointerMove);\n    removeEventListener('pointerup', this._handlePointerUp);\n\n    removeEventListener('mousemove', this._handleMouseMove);\n    removeEventListener('mouseup', this._handleMouseUp);\n\n    removeEventListener('touchmove', this._handleTouchMove);\n    removeEventListener('touchend', this._handleTouchEnd);\n  }\n\n  public isEmpty(): boolean {\n    return this._isEmpty;\n  }\n\n  public fromData(\n    pointGroups: PointGroup[],\n    { clear = true }: FromDataOptions = {},\n  ): void {\n    if (clear) {\n      this.clear();\n    }\n\n    this._fromData(\n      pointGroups,\n      this._drawCurve.bind(this),\n      this._drawDot.bind(this),\n    );\n\n    this._data = this._data.concat(pointGroups);\n  }\n\n  public toData(): PointGroup[] {\n    return this._data;\n  }\n\n  public _isLeftButtonPressed(event: MouseEvent, only?: boolean): boolean {\n    if (only) {\n      return event.buttons === 1;\n    }\n\n    return (event.buttons & 1) === 1;\n  }\n  private _pointerEventToSignatureEvent(\n    event: MouseEvent | PointerEvent,\n  ): SignatureEvent {\n    return {\n      event: event,\n      type: event.type,\n      x: event.clientX,\n      y: event.clientY,\n      pressure: 'pressure' in event ? event.pressure : 0,\n    };\n  }\n\n  private _touchEventToSignatureEvent(event: TouchEvent): SignatureEvent {\n    const touch = event.changedTouches[0];\n    return {\n      event: event,\n      type: event.type,\n      x: touch.clientX,\n      y: touch.clientY,\n      pressure: touch.force,\n    };\n  }\n\n  // Event handlers\n  private _handleMouseDown = (event: MouseEvent): void => {\n    if (!this._isLeftButtonPressed(event, true) || this._drawingStroke) {\n      return;\n    }\n    this._strokeBegin(this._pointerEventToSignatureEvent(event));\n  };\n\n  private _handleMouseMove = (event: MouseEvent): void => {\n    if (!this._isLeftButtonPressed(event, true) || !this._drawingStroke) {\n      // Stop when not pressing primary button or pressing multiple buttons\n      this._strokeEnd(this._pointerEventToSignatureEvent(event), false);\n      return;\n    }\n\n    this._strokeMoveUpdate(this._pointerEventToSignatureEvent(event));\n  };\n\n  private _handleMouseUp = (event: MouseEvent): void => {\n    if (this._isLeftButtonPressed(event)) {\n      return;\n    }\n\n    this._strokeEnd(this._pointerEventToSignatureEvent(event));\n  };\n\n  private _handleTouchStart = (event: TouchEvent): void => {\n    if (event.targetTouches.length !== 1 || this._drawingStroke) {\n      return;\n    }\n\n    // Prevent scrolling.\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n\n    this._strokeBegin(this._touchEventToSignatureEvent(event));\n  };\n\n  private _handleTouchMove = (event: TouchEvent): void => {\n    if (event.targetTouches.length !== 1) {\n      return;\n    }\n\n    // Prevent scrolling.\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n\n    if (!this._drawingStroke) {\n      this._strokeEnd(this._touchEventToSignatureEvent(event), false);\n      return;\n    }\n\n    this._strokeMoveUpdate(this._touchEventToSignatureEvent(event));\n  };\n\n  private _handleTouchEnd = (event: TouchEvent): void => {\n    if (event.targetTouches.length !== 0) {\n      return;\n    }\n\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n\n    this.canvas.removeEventListener('touchmove', this._handleTouchMove);\n\n    this._strokeEnd(this._touchEventToSignatureEvent(event));\n  };\n\n  private _handlePointerDown = (event: PointerEvent): void => {\n    if (!event.isPrimary || !this._isLeftButtonPressed(event) || this._drawingStroke) {\n      return;\n    }\n\n    event.preventDefault();\n\n    this._strokeBegin(this._pointerEventToSignatureEvent(event));\n  };\n\n  private _handlePointerMove = (event: PointerEvent): void => {\n    if (!event.isPrimary) {\n      return;\n    }\n    if (!this._isLeftButtonPressed(event, true) || !this._drawingStroke) {\n      // Stop when primary button not pressed or multiple buttons pressed\n      this._strokeEnd(this._pointerEventToSignatureEvent(event), false);\n      return;\n    }\n\n    event.preventDefault();\n    this._strokeMoveUpdate(this._pointerEventToSignatureEvent(event));\n  };\n\n  private _handlePointerUp = (event: PointerEvent): void => {\n    if (!event.isPrimary || this._isLeftButtonPressed(event)) {\n      return;\n    }\n\n    event.preventDefault();\n    this._strokeEnd(this._pointerEventToSignatureEvent(event));\n  };\n\n  private _getPointGroupOptions(group?: PointGroup): PointGroupOptions {\n    return {\n      penColor: group && 'penColor' in group ? group.penColor : this.penColor,\n      dotSize: group && 'dotSize' in group ? group.dotSize : this.dotSize,\n      minWidth: group && 'minWidth' in group ? group.minWidth : this.minWidth,\n      maxWidth: group && 'maxWidth' in group ? group.maxWidth : this.maxWidth,\n      velocityFilterWeight:\n        group && 'velocityFilterWeight' in group\n          ? group.velocityFilterWeight\n          : this.velocityFilterWeight,\n      compositeOperation:\n        group && 'compositeOperation' in group\n          ? group.compositeOperation\n          : this.compositeOperation,\n    };\n  }\n\n  // Private methods\n  private _strokeBegin(event: SignatureEvent): void {\n    const cancelled = !this.dispatchEvent(\n      new CustomEvent('beginStroke', { detail: event, cancelable: true }),\n    );\n    if (cancelled) {\n      return;\n    }\n\n    const { addEventListener } = this._getListenerFunctions();\n    switch (event.event.type) {\n      case 'mousedown':\n        addEventListener('mousemove', this._handleMouseMove);\n        addEventListener('mouseup', this._handleMouseUp);\n        break;\n      case 'touchstart':\n        addEventListener('touchmove', this._handleTouchMove);\n        addEventListener('touchend', this._handleTouchEnd);\n        break;\n      case 'pointerdown':\n        addEventListener('pointermove', this._handlePointerMove);\n        addEventListener('pointerup', this._handlePointerUp);\n        break;\n      default:\n      // do nothing\n    }\n\n    this._drawingStroke = true;\n\n    const pointGroupOptions = this._getPointGroupOptions();\n\n    const newPointGroup: PointGroup = {\n      ...pointGroupOptions,\n      points: [],\n    };\n\n    this._data.push(newPointGroup);\n    this._reset(pointGroupOptions);\n    this._strokeUpdate(event);\n  }\n\n  private _strokeUpdate(event: SignatureEvent): void {\n    if (!this._drawingStroke) {\n      return;\n    }\n\n    if (this._data.length === 0) {\n      // This can happen if clear() was called while a signature is still in progress,\n      // or if there is a race condition between start/update events.\n      this._strokeBegin(event);\n      return;\n    }\n\n    this.dispatchEvent(\n      new CustomEvent('beforeUpdateStroke', { detail: event }),\n    );\n\n    const point = this._createPoint(event.x, event.y, event.pressure);\n    const lastPointGroup = this._data[this._data.length - 1];\n    const lastPoints = lastPointGroup.points;\n    const lastPoint =\n      lastPoints.length > 0 && lastPoints[lastPoints.length - 1];\n    const isLastPointTooClose = lastPoint\n      ? point.distanceTo(lastPoint) <= this.minDistance\n      : false;\n    const pointGroupOptions = this._getPointGroupOptions(lastPointGroup);\n\n    // Skip this point if it's too close to the previous one\n    if (!lastPoint || !(lastPoint && isLastPointTooClose)) {\n      const curve = this._addPoint(point, pointGroupOptions);\n\n      if (!lastPoint) {\n        this._drawDot(point, pointGroupOptions);\n      } else if (curve) {\n        this._drawCurve(curve, pointGroupOptions);\n      }\n\n      lastPoints.push({\n        time: point.time,\n        x: point.x,\n        y: point.y,\n        pressure: point.pressure,\n      });\n    }\n\n    this.dispatchEvent(new CustomEvent('afterUpdateStroke', { detail: event }));\n  }\n\n  private _strokeEnd(event: SignatureEvent, shouldUpdate = true): void {\n    this._removeMoveUpEventListeners();\n\n    if (!this._drawingStroke) {\n      return;\n    }\n\n    if (shouldUpdate) {\n      this._strokeUpdate(event);\n    }\n\n    this._drawingStroke = false;\n    this.dispatchEvent(new CustomEvent('endStroke', { detail: event }));\n  }\n\n  private _handlePointerEvents(): void {\n    this._drawingStroke = false;\n\n    this.canvas.addEventListener('pointerdown', this._handlePointerDown);\n  }\n\n  private _handleMouseEvents(): void {\n    this._drawingStroke = false;\n\n    this.canvas.addEventListener('mousedown', this._handleMouseDown);\n  }\n\n  private _handleTouchEvents(): void {\n    this.canvas.addEventListener('touchstart', this._handleTouchStart);\n  }\n\n  // Called when a new line is started\n  private _reset(options: PointGroupOptions): void {\n    this._lastPoints = [];\n    this._lastVelocity = 0;\n    this._lastWidth = (options.minWidth + options.maxWidth) / 2;\n    this._ctx.fillStyle = options.penColor;\n    this._ctx.globalCompositeOperation = options.compositeOperation;\n  }\n\n  private _createPoint(x: number, y: number, pressure: number): Point {\n    const rect = this.canvas.getBoundingClientRect();\n\n    return new Point(\n      x - rect.left,\n      y - rect.top,\n      pressure,\n      new Date().getTime(),\n    );\n  }\n\n  // Add point to _lastPoints array and generate a new curve if there are enough points (i.e. 3)\n  private _addPoint(point: Point, options: PointGroupOptions): Bezier | null {\n    const { _lastPoints } = this;\n\n    _lastPoints.push(point);\n\n    if (_lastPoints.length > 2) {\n      // To reduce the initial lag make it work with 3 points\n      // by copying the first point to the beginning.\n      if (_lastPoints.length === 3) {\n        _lastPoints.unshift(_lastPoints[0]);\n      }\n\n      // _points array will always have 4 points here.\n      const widths = this._calculateCurveWidths(\n        _lastPoints[1],\n        _lastPoints[2],\n        options,\n      );\n      const curve = Bezier.fromPoints(_lastPoints, widths);\n\n      // Remove the first element from the list, so that there are no more than 4 points at any time.\n      _lastPoints.shift();\n\n      return curve;\n    }\n\n    return null;\n  }\n\n  private _calculateCurveWidths(\n    startPoint: Point,\n    endPoint: Point,\n    options: PointGroupOptions,\n  ): { start: number; end: number } {\n    const velocity =\n      options.velocityFilterWeight * endPoint.velocityFrom(startPoint) +\n      (1 - options.velocityFilterWeight) * this._lastVelocity;\n\n    const newWidth = this._strokeWidth(velocity, options);\n\n    const widths = {\n      end: newWidth,\n      start: this._lastWidth,\n    };\n\n    this._lastVelocity = velocity;\n    this._lastWidth = newWidth;\n\n    return widths;\n  }\n\n  private _strokeWidth(velocity: number, options: PointGroupOptions): number {\n    return Math.max(options.maxWidth / (velocity + 1), options.minWidth);\n  }\n\n  private _drawCurveSegment(x: number, y: number, width: number): void {\n    const ctx = this._ctx;\n\n    ctx.moveTo(x, y);\n    ctx.arc(x, y, width, 0, 2 * Math.PI, false);\n    this._isEmpty = false;\n  }\n\n  private _drawCurve(curve: Bezier, options: PointGroupOptions): void {\n    const ctx = this._ctx;\n    const widthDelta = curve.endWidth - curve.startWidth;\n    // '2' is just an arbitrary number here. If only length is used, then\n    // there are gaps between curve segments :/\n    const drawSteps = Math.ceil(curve.length()) * 2;\n\n    ctx.beginPath();\n    ctx.fillStyle = options.penColor;\n\n    for (let i = 0; i < drawSteps; i += 1) {\n      // Calculate the Bezier (x, y) coordinate for this step.\n      const t = i / drawSteps;\n      const tt = t * t;\n      const ttt = tt * t;\n      const u = 1 - t;\n      const uu = u * u;\n      const uuu = uu * u;\n\n      let x = uuu * curve.startPoint.x;\n      x += 3 * uu * t * curve.control1.x;\n      x += 3 * u * tt * curve.control2.x;\n      x += ttt * curve.endPoint.x;\n\n      let y = uuu * curve.startPoint.y;\n      y += 3 * uu * t * curve.control1.y;\n      y += 3 * u * tt * curve.control2.y;\n      y += ttt * curve.endPoint.y;\n\n      const width = Math.min(\n        curve.startWidth + ttt * widthDelta,\n        options.maxWidth,\n      );\n      this._drawCurveSegment(x, y, width);\n    }\n\n    ctx.closePath();\n    ctx.fill();\n  }\n\n  private _drawDot(point: BasicPoint, options: PointGroupOptions): void {\n    const ctx = this._ctx;\n    const width =\n      options.dotSize > 0\n        ? options.dotSize\n        : (options.minWidth + options.maxWidth) / 2;\n\n    ctx.beginPath();\n    this._drawCurveSegment(point.x, point.y, width);\n    ctx.closePath();\n    ctx.fillStyle = options.penColor;\n    ctx.fill();\n  }\n\n  private _fromData(\n    pointGroups: PointGroup[],\n    drawCurve: SignaturePad['_drawCurve'],\n    drawDot: SignaturePad['_drawDot'],\n  ): void {\n    for (const group of pointGroups) {\n      const { points } = group;\n      const pointGroupOptions = this._getPointGroupOptions(group);\n\n      if (points.length > 1) {\n        for (let j = 0; j < points.length; j += 1) {\n          const basicPoint = points[j];\n          const point = new Point(\n            basicPoint.x,\n            basicPoint.y,\n            basicPoint.pressure,\n            basicPoint.time,\n          );\n\n          if (j === 0) {\n            this._reset(pointGroupOptions);\n          }\n\n          const curve = this._addPoint(point, pointGroupOptions);\n\n          if (curve) {\n            drawCurve(curve, pointGroupOptions);\n          }\n        }\n      } else {\n        this._reset(pointGroupOptions);\n\n        drawDot(points[0], pointGroupOptions);\n      }\n    }\n  }\n\n  public toSVG({ includeBackgroundColor = false }: ToSVGOptions = {}): string {\n    const pointGroups = this._data;\n    const ratio = Math.max(window.devicePixelRatio || 1, 1);\n    const minX = 0;\n    const minY = 0;\n    const maxX = this.canvas.width / ratio;\n    const maxY = this.canvas.height / ratio;\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n\n    svg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n    svg.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink');\n    svg.setAttribute('viewBox', `${minX} ${minY} ${maxX} ${maxY}`);\n    svg.setAttribute('width', maxX.toString());\n    svg.setAttribute('height', maxY.toString());\n\n    if (includeBackgroundColor && this.backgroundColor) {\n      const rect = document.createElement('rect');\n      rect.setAttribute('width', '100%');\n      rect.setAttribute('height', '100%');\n      rect.setAttribute('fill', this.backgroundColor);\n\n      svg.appendChild(rect);\n    }\n\n    this._fromData(\n      pointGroups,\n\n      (curve, { penColor }) => {\n        const path = document.createElement('path');\n\n        // Need to check curve for NaN values, these pop up when drawing\n        // lines on the canvas that are not continuous. E.g. Sharp corners\n        // or stopping mid-stroke and than continuing without lifting mouse.\n        if (\n          !isNaN(curve.control1.x) &&\n          !isNaN(curve.control1.y) &&\n          !isNaN(curve.control2.x) &&\n          !isNaN(curve.control2.y)\n        ) {\n          const attr =\n            `M ${curve.startPoint.x.toFixed(3)},${curve.startPoint.y.toFixed(\n              3,\n            )} ` +\n            `C ${curve.control1.x.toFixed(3)},${curve.control1.y.toFixed(3)} ` +\n            `${curve.control2.x.toFixed(3)},${curve.control2.y.toFixed(3)} ` +\n            `${curve.endPoint.x.toFixed(3)},${curve.endPoint.y.toFixed(3)}`;\n          path.setAttribute('d', attr);\n          path.setAttribute('stroke-width', (curve.endWidth * 2.25).toFixed(3));\n          path.setAttribute('stroke', penColor);\n          path.setAttribute('fill', 'none');\n          path.setAttribute('stroke-linecap', 'round');\n\n          svg.appendChild(path);\n        }\n      },\n\n      (point, { penColor, dotSize, minWidth, maxWidth }) => {\n        const circle = document.createElement('circle');\n        const size = dotSize > 0 ? dotSize : (minWidth + maxWidth) / 2;\n        circle.setAttribute('r', size.toString());\n        circle.setAttribute('cx', point.x.toString());\n        circle.setAttribute('cy', point.y.toString());\n        circle.setAttribute('fill', penColor);\n\n        svg.appendChild(circle);\n      },\n    );\n\n    return svg.outerHTML;\n  }\n}\n", "import {BaseComponent} from './BaseComponent.js';\nimport SignaturePad from 'signature_pad';\nimport {U} from \"../U\";\n\nexport class SignatureComponent extends BaseComponent {\n\n    html() {\n\n        const wrapper = document.createElement(\"div\");\n        wrapper.classList.add(\"signature-pad\");\n\n        const field = document.createElement(\"div\");\n        field.classList.add(\"field\");\n\n        const control = document.createElement(\"div\");\n        control.classList.add(\"control\");\n\n        field.appendChild(control);\n\n        const label = document.createElement(\"div\");\n        label.classList.add(\"label\");\n        label.innerText = this.config.label + U.requiredMark(this.config);\n        control.appendChild(label);\n\n        const tooltip = U.tooltipHint(this.config);\n        control.insertAdjacentHTML('beforeend', tooltip);\n\n        const input = document.createElement(\"input\");\n        input.type = \"hidden\";\n        input.name = this.name;\n        control.appendChild(input);\n\n        const canvas = document.createElement(\"canvas\");\n        control.appendChild(canvas);\n        wrapper.appendChild(field);\n\n        const signaturePad = new SignaturePad(canvas);\n        // default input event is of no use here\n        signaturePad.addEventListener(\"endStroke\", () => {\n            this.myState.value = signaturePad.toDataURL();\n        });\n\n\n        const fieldButton = document.createElement(\"div\");\n        fieldButton.classList.add(\"field\");\n\n        const controlButton = document.createElement(\"div\");\n        controlButton.classList.add(\"control\");\n\n        fieldButton.appendChild(controlButton);\n\n        const clearButton = document.createElement(\"button\");\n        clearButton.classList.add(\"button\", \"clear\");\n        clearButton.type = \"button\";\n        clearButton.innerText = U.getLang('label_signature_delete');\n        clearButton.addEventListener(\"click\", function (event) {\n            signaturePad.clear();\n            this.myState.value.value = null;\n        });\n\n        controlButton.appendChild(clearButton);\n\n        wrapper.appendChild(fieldButton);\n\n        return wrapper;\n    }\n}\n\ncustomElements.define('signature-component', SignatureComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport {U} from '../U.js';\n\nexport class TableComponent extends BaseComponent {\n    html() {\n        const tableElement = document.createElement('table');\n        // like fieldsets, tables need a name for building full dotted paths\n        tableElement.name = this.config.name;\n        tableElement.classList.add('table');\n\n        const repeat = parseInt(this.config.repeat);\n        const columnHeaders = U.getTableColumnHeaders(this.config.label, repeat);\n\n        const thead = document.createElement('thead');\n        const headRow = document.createElement('tr');\n\n        for (const header of columnHeaders) {\n            const th = document.createElement('th');\n            th.innerText = header;\n            headRow.appendChild(th);\n        }\n        tableElement.appendChild(headRow);\n\n        U.attachTableRows(tableElement, this.config['children'], this.myState.state, repeat);\n\n        return tableElement;\n    }\n\n    /** @override */\n    htmlWrap(html) {\n        const wrapper = document.createElement('div');\n        if (this.config.scrollable) {\n            wrapper.classList.add('table-container');\n        }\n        if (typeof html === 'string') {\n            wrapper.innerHTML = html;\n        } else {\n            wrapper.appendChild(html);\n        }\n        return wrapper;\n    }\n\n    executeValidators() {\n        return true;\n    }\n}\n\ncustomElements.define('table-component', TableComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\nimport {U} from '../U.js';\n\nexport class TextareaComponent extends BaseComponent {\n    html() {\n        return html`\n            <div class=\"field\">\n                <label class=\"label\">${this.config.label}${U.requiredMark(this.config)}</label>$${U.tooltipHint(this.config)}\n                <div class=\"control\">\n                    <textarea class=\"textarea\"\n                        ${U.attrHTML('placeholder', this.config.placeholder, false)}\n                        ${U.attrHTML('cols', this.config.cols, false)}\n                        ${U.attrHTML('rows', this.config.rows, false)}\n                        name=\"${this.name}\" ${this.config.readonly ? 'readonly' : ''}>${this.myState.value ?? ''}</textarea>\n                </div>\n            </div>\n        `;\n    }\n}\n\ncustomElements.define('textarea-component', TextareaComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\nimport {U} from '../U.js';\nimport {ValidatorError} from \"../ValidatorError\";\n\nexport class TextinputComponent extends BaseComponent {\n\n    html() {\n        const field = document.createElement(\"div\");\n        field.classList.add(\"field\");\n\n        const label = document.createElement(\"label\");\n        label.classList.add(\"label\")\n        label.innerText = html`${this.config.label}` + U.requiredMark(this.config);\n\n\n        field.appendChild(label);\n        field.insertAdjacentHTML('beforeend', U.tooltipHint(this.config));\n        if (this.config.modal) {\n            field.appendChild(U.modalHint(this.config));\n            field.appendChild(U.modal(this.config));\n        }\n\n        const control = document.createElement(\"div\");\n        control.classList.add(\"control\");\n\n        field.appendChild(control);\n\n        const input = document.createElement(\"input\");\n        input.type = \"text\";\n        input.name = this.config.name;\n        input.classList.add(\"input\");\n        input.placeholder = this.config.placeholder || \"\";\n        input.value = this.myState.value ?? null;\n        input.readOnly = !!this.config.readonly;\n\n        control.appendChild(input);\n\n        return field;\n    }\n\n\n    /**\n     * Handle \"match\" validation\n     */\n    executeValidators() {\n        super.executeValidators();\n\n        if (\n            this.config.validation && this.config.validation.match\n        ) {\n            const pattern = this.config.validation.match.replace(/^\\/|\\/$/g, '');\n            const regex = new RegExp(pattern);\n            // a null value is internally converted into the string \"null\", so replace it with \"\"\n            if (regex.test(this.myState.value || \"\") === false) {\n                throw new ValidatorError(this.name, U.getLang(\"error_match\"));\n            }\n        }\n    }\n\n}\n\ncustomElements.define('textinput-component', TextinputComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\nimport {U} from '../U.js';\n\nexport class TimeComponent extends BaseComponent {\n    html() {\n        return html`\n            <div class=\"field\">\n                <label class=\"label\">${this.config.label}${U.requiredMark(this.config)}</label>$${U.tooltipHint(this.config)}\n                <div class=\"control\">\n                    <input class=\"input\" type=\"time\" name=\"${this.name}\"\n                           ${U.attrHTML('placeholder', this.config.placeholder, false)}\n                           value=\"${this.myState.value ?? ''}\"\n                           ${this.config.readonly ? 'readonly' : ''}>\n                </div>\n            </div>\n        `;\n    }\n}\n\ncustomElements.define('time-component', TimeComponent);\n", "import {BaseComponent} from './BaseComponent.js';\nimport html from 'html-template-tag';\n\nexport class UploadComponent extends BaseComponent {\n\n    html() {\n        return html`\n            <div class=\"field\">\n                <div class=\"control\">\n                    FIXME upload\n                </div>\n            </div>\n        `;\n    }\n}\n\ncustomElements.define('upload-component', UploadComponent);\n", "import {U} from '../U.js';\nimport {State} from \"../State\";\n\n/**\n * Ideas\n *\n * register an event handler onChange or maybe onInput on the Form Component\n * when a change is detected, update the data using the JS FormData Api\n *   - this might happen automatically if we initialize FormData with the form element once\n *   - alternatively we could also maybe do a diff between the old and new form data\n * trigger a custom event on the FormComponent\n * the BaseField can find the FormComponent by traversing the DOM upwards on initialization\n * the BaseField should listen to the custom event on the FormComponent\n *   - maybe even only when needed, eg. when there are any dependencies\n * this event would trigger several things:\n *   - general dependency checks (like should the component be visible or not)\n *   - validation checks\n *   - dependency checks for dropdown options\n *   - generally we do not really need to completely rerender here, though we could use dom diffing\n *\n * questions:\n *   - how would we deal with initial data, when we use a FormData object?\n *   - child elements like clone or table, need the initial data to know how many copies to render\n */\n\n\n\nexport class FormComponent extends HTMLElement {\n\n    #form;\n    #state;\n    #formConfig;\n\n    constructor() {\n        super();\n\n        this.#form = document.createElement('form');\n        this.appendChild(this.#form);\n        this.#formConfig = U.loadFormConfig();\n        this.#state = new State(U.loadFormState());\n    }\n\n    connectedCallback() {\n        this.render();\n    }\n\n    render() {\n        const errorContainer = document.createElement('div');\n        errorContainer.classList.add('notification');\n        errorContainer.style.display = 'none';\n        this.prepend(errorContainer);\n\n        this.attachElements(this.#form);\n        this.attachButtons(this.#form);\n\n        this.#form.addEventListener('submit', this.handleSubmit.bind(this));\n    }\n\n    attachElements(parent) {\n        U.attachChildren(parent, this.#formConfig, this.#state);\n    }\n\n    attachButtons(form) {\n        const formControlButtons = document.createElement('div');\n        formControlButtons.innerHTML =\n            `<div class=\"field is-grouped has-addons has-addons-centered\">\n                <div class=\"control\">\n                    <button class=\"button is-link\" type=\"submit\" name=\"formcontrol[save]\">\n                        ${U.getLang(\"button_save\")}\n                    </button>\n                </div>\n                <div class=\"control\">\n                    <button class=\"button is-link\" type=\"submit\" name=\"formcontrol[send]\">\n                        ${U.getLang(\"button_send\")}\n                    </button>\n                </div>\n            </div>`;\n        form.appendChild(formControlButtons);\n    }\n\n    validate() {\n        const components = this.querySelectorAll('.component');\n        let ok = true;\n\n        components.forEach(component => {\n            ok &= component.validate();\n        });\n\n        return ok;\n    }\n\n\n    handleSubmit(event) {\n        event.preventDefault();\n\n        const isValid = this.validate();\n\n        this.#displayFormStatusNotofication(isValid);\n\n        console.log('SUBMIT', this.#state.values);\n        console.log('SUBMIT VALIDATION', isValid);\n    }\n\n    #displayFormStatusNotofication(isValid) {\n        const notification = this.querySelector('.notification');\n\n        if (!isValid) {\n            notification.classList.add('is-danger');\n            notification.classList.remove('is-success');\n            notification.innerHTML = `<p>${U.getLang(\"form_invalid\")}</p>`;\n        } else {\n            notification.classList.remove('is-danger');\n            notification.classList.add('is-success');\n            notification.innerHTML = `<p>${U.getLang(\"form_valid\")}</p>`;\n        }\n\n        notification.style.display = 'block';\n\n    }\n}\n\ncustomElements.define('form-component', FormComponent);\n"],
  "mappings": "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,SACA,QACA,UACA,WACA,OACA,iBACA,QACA,MACA,SACA,SACA,SACA,OACF,EACA,MAAO,CACL,SACA,QACA,MACA,eACA,UACA,UACA,WACA,OACA,aACA,cACA,aACA,iBACA,aACA,SACA,QACA,OACA,MACA,YACA,MACA,YACA,WACA,OACA,UACA,cACA,gBACA,sBACA,WACA,WACA,OACA,MACA,OACA,OACA,SACA,QACA,OACF,EACA,IAAK,CAAC,OAAQ,UAAU,EACxB,QAAS,CAAC,QAAQ,EAClB,MAAO,CAAC,MAAO,MAAM,EACrB,OAAQ,CAAC,OAAO,EAChB,GAAI,CAAC,OAAQ,OAAO,EACpB,KAAM,CACJ,KACA,WACA,UACA,QACA,cACA,WACA,gBACA,OACA,WACA,aACA,cACA,YACA,QACA,iBACA,MACA,MACA,QACA,SACA,MACF,EACA,IAAK,CAAC,MAAM,EACZ,KAAM,CAAC,SAAS,EAChB,KAAM,CAAC,UAAW,UAAW,aAAc,QAAS,OAAQ,QAAQ,EACpE,MAAO,CAAC,OAAQ,MAAO,MAAO,MAAO,UAAW,OAAO,EACvD,OAAQ,CACN,QACA,UACA,SACA,UACA,WACA,WACA,OACA,UACA,OACA,SACA,SACA,OACA,UACA,OACA,gBACA,SACA,SACA,OACF,EACA,GAAI,CAAC,UAAW,WAAY,QAAS,MAAM,EAC3C,SAAU,CAAC,WAAY,OAAO,EAC9B,OAAQ,CAAC,WAAY,QAAS,WAAY,OAAO,EACjD,OAAQ,CAAC,MAAO,OAAQ,MAAM,EAC9B,EAAG,CAAC,OAAO,EACX,MAAO,CAAC,OAAQ,OAAQ,QAAS,WAAW,EAC5C,IAAK,CAAC,OAAO,EACb,SAAU,CAAC,MAAO,OAAO,EACzB,EAAG,CAAC,MAAM,EACV,OAAQ,CACN,QACA,WACA,UACA,cACA,QACA,gBACA,YACA,WACA,WACA,iBACA,MACA,MACF,EACA,OAAQ,CACN,eACA,WACA,OACA,WACA,OACA,WACA,MACF,EACA,KAAM,CAAC,MAAM,EACb,OAAQ,CAAC,SAAU,QAAS,QAAS,MAAO,SAAU,OAAQ,OAAO,EACrE,MAAO,CAAC,WAAY,QAAS,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",
  "names": ["DOCUMENT_FRAGMENT_NODE", "morphAttrs", "fromNode", "toNode", "toNodeAttrs", "attr", "attrName", "attrNamespaceURI", "attrValue", "fromValue", "i", "fromNodeAttrs", "d", "range", "NS_XHTML", "doc", "HAS_TEMPLATE_SUPPORT", "HAS_RANGE_SUPPORT", "createFragmentFromTemplate", "str", "template", "createFragmentFromRange", "fragment", "createFragmentFromWrap", "toElement", "compareNodeNames", "fromEl", "toEl", "fromNodeName", "toNodeName", "fromCodeStart", "toCodeStart", "createElementNS", "name", "namespaceURI", "moveChildren", "curChild", "nextChild", "syncBooleanAttrProp", "specialElHandlers", "parentNode", "parentName", "newValue", "firstChild", "oldValue", "selectedIndex", "optgroup", "nodeName", "ELEMENT_NODE", "DOCUMENT_FRAGMENT_NODE$1", "TEXT_NODE", "COMMENT_NODE", "noop", "defaultGetNodeKey", "node", "morphdomFactory", "options", "toNodeHtml", "getNodeKey", "onBeforeNodeAdded", "onNodeAdded", "onBeforeElUpdated", "onElUpdated", "onBeforeNodeDiscarded", "onNodeDiscarded", "onBeforeElChildrenUpdated", "skipFromChildren", "addChild", "parent", "child", "childrenOnly", "fromNodesLookup", "keyedRemovalList", "addKeyedRemoval", "key", "walkDiscardedChildNodes", "skipKeyedNodes", "removeNode", "indexTree", "handleNodeAdded", "el", "nextSibling", "unmatchedFromEl", "morphEl", "cleanupFromEl", "curFromNodeChild", "curFromNodeKey", "fromNextSibling", "toElKey", "beforeUpdateResult", "morphChildren", "skipFrom", "curToNodeChild", "curToNodeKey", "toNextSibling", "matchingFromEl", "outer", "curFromNodeType", "isCompatible", "onBeforeNodeAddedResult", "specialElHandler", "morphedNode", "morphedNodeType", "toNodeType", "len", "elToRemove", "morphdom", "morphdom_esm_default", "isObject", "value", "type", "disallowedKeys", "digits", "getPathSegments", "path", "parts", "currentSegment", "currentPart", "isIgnoring", "character", "isStringIndex", "object", "key", "index", "assertNotStringIndex", "getProperty", "value", "isObject", "pathArray", "setProperty", "root", "deleteProperty", "State", "_State", "initialValues", "#createProxy", "withEvent", "target", "name", "value", "deleteProperty", "setProperty", "event", "getProperty", "ComponentState", "#name", "state", "name", "value", "ValidatorError", "componentName", "message", "args", "INUMBER", "IOP1", "IOP2", "IOP3", "IVAR", "IVARNAME", "IFUNCALL", "IFUNDEF", "IEXPR", "IEXPREVAL", "IMEMBER", "IENDSTATEMENT", "IARRAY", "Instruction", "type", "value", "unaryInstruction", "binaryInstruction", "ternaryInstruction", "simplify", "tokens", "unaryOps", "binaryOps", "ternaryOps", "values", "nstack", "newexpression", "n1", "n2", "n3", "f", "i", "item", "x", "substitute", "variable", "expr", "j", "expritem", "replitem", "evaluate", "args", "argCount", "isExpressionEvaluator", "resolveExpression", "numTokens", "v", "scope", "len", "createExpressionEvaluator", "token", "n", "expressionToString", "toJS", "escapeValue", "contains", "array", "obj", "getSymbols", "symbols", "options", "withMembers", "prevVar", "Expression", "parser", "vars", "functions", "name", "param", "variables", "TEOF", "TOP", "TNUMBER", "TSTRING", "TPAREN", "TBRACKET", "TCOMMA", "TNAME", "TSEMICOLON", "Token", "index", "TokenStream", "expression", "pos", "r", "startPos", "quote", "rawString", "c", "str", "hasLetter", "codePointPattern", "buffer", "codePoint", "backslash", "radix", "validDigit", "valid", "resetPos", "foundDot", "foundDigits", "acceptSign", "validExponent", "op", "line", "column", "newline", "msg", "coords", "ParserState", "tokenStream", "instr", "isPrefixOperator", "exprInstr", "varName", "varValue", "lastInstrIndex", "trueBranch", "falseBranch", "COMPARISON_OPERATORS", "ADD_SUB_OPERATORS", "TERM_OPERATORS", "add", "a", "b", "sub", "mul", "div", "mod", "concat", "equal", "notEqual", "greaterThan", "lessThan", "greaterThanEqual", "lessThanEqual", "andOperator", "orOperator", "inOperator", "sinh", "cosh", "tanh", "asinh", "acosh", "atanh", "log10", "neg", "not", "trunc", "random", "factorial", "gamma", "isInteger", "GAMMA_G", "GAMMA_P", "res", "twoN", "threeN", "fourN", "fiveN", "stringOrArrayLength", "s", "hypot", "sum", "larg", "arg", "condition", "cond", "yep", "nope", "roundTo", "exp", "setVar", "arrayIndex", "max", "min", "arrayMap", "arrayFold", "init", "acc", "arrayFilter", "stringOrArrayIndexOf", "target", "arrayJoin", "sep", "sign", "ONE_THIRD", "cbrt", "expm1", "log1p", "log2", "Parser", "parserState", "sharedParser", "optionNameMap", "getOptionName", "optionName", "operators", "dist_default", "U", "name", "value", "specialChars", "config", "hint", "e", "modal", "backdrop", "#closeModal", "contentContainer", "content", "button", "parentElement", "childrenConfig", "state", "parentName", "columnWrapper", "key", "fieldConfig", "element", "repeat", "rowWrapper", "labelTh", "i", "idx", "fieldTd", "label", "headers", "visible", "dist_default", "expression", "vars", "data", "v", "setProperty", "BaseComponent", "_BaseComponent", "#isInitialized", "#visibilityExpression", "state", "fieldConfig", "ComponentState", "U", "State", "html", "disposableWrapper", "morphdom_esm_default", "el", "wrapper", "errorElement", "ValidatorError", "e", "target", "detail", "ChecklistComponent", "BaseComponent", "checklist", "label", "U", "tooltip", "control", "option", "optionLabel", "checked", "target", "state", "t", "e", "n", "htmlElementAttributes", "r", "htmlElementAttributes", "n", "t", "e", "a", "o", "i", "c", "DateComponent", "BaseComponent", "i", "U", "DatetimeComponent", "BaseComponent", "i", "U", "DownloadComponent", "BaseComponent", "i", "DropdownComponent", "BaseComponent", "state", "fieldConfig", "select", "option", "availableChoices", "#getAvailableChoices", "optionLabel", "selectContainer", "control", "field", "label", "U", "tooltip", "target", "detail", "vars", "expr", "expressions", "set", "flattened", "ch", "EmailComponent", "BaseComponent", "i", "U", "FieldsetComponent", "BaseComponent", "fieldSetElement", "U", "HiddenComponent", "BaseComponent", "i", "HrComponent", "BaseComponent", "i", "ImageComponent", "BaseComponent", "i", "MarkdownComponent", "BaseComponent", "i", "NumberinputComponent", "BaseComponent", "i", "U", "ValidatorError", "RadiosetComponent", "BaseComponent", "radioset", "label", "U", "tooltip", "control", "option", "optionLabel", "checked", "Point", "x", "y", "pressure", "time", "start", "other", "Bezier", "_Bezier", "points", "widths", "c2", "c3", "s1", "s2", "s3", "dx1", "dy1", "dx2", "dy2", "m1", "m2", "l1", "l2", "dxm", "dym", "k", "cm", "tx", "ty", "startPoint", "control2", "control1", "endPoint", "startWidth", "endWidth", "length", "px", "py", "i", "t", "cx", "cy", "xdiff", "ydiff", "c1", "end", "SignatureEventTarget", "type", "listener", "options", "event", "callback", "throttle", "fn", "wait", "previous", "timeout", "result", "storedContext", "storedArgs", "later", "args", "now", "remaining", "SignaturePad", "_SignaturePad", "canvas", "_a", "_b", "_c", "ctx", "dataUrl", "resolve", "reject", "image", "ratio", "width", "height", "xOffset", "yOffset", "error", "encoderOptions", "isIOS", "canvasWindow", "removeEventListener", "pointGroups", "clear", "only", "touch", "group", "addEventListener", "pointGroupOptions", "newPointGroup", "point", "lastPointGroup", "lastPoints", "lastPoint", "isLastPointTooClose", "curve", "shouldUpdate", "rect", "_lastPoints", "velocity", "newWidth", "widthDelta", "drawSteps", "tt", "ttt", "u", "uu", "uuu", "drawCurve", "drawDot", "j", "basicPoint", "includeBackgroundColor", "minX", "minY", "maxX", "maxY", "svg", "penColor", "path", "attr", "dotSize", "minWidth", "maxWidth", "circle", "size", "SignatureComponent", "BaseComponent", "wrapper", "field", "control", "label", "U", "tooltip", "input", "canvas", "signaturePad", "SignaturePad", "fieldButton", "controlButton", "clearButton", "event", "TableComponent", "BaseComponent", "tableElement", "repeat", "columnHeaders", "U", "thead", "headRow", "header", "th", "html", "wrapper", "TextareaComponent", "BaseComponent", "i", "U", "TextinputComponent", "BaseComponent", "field", "label", "i", "U", "control", "input", "pattern", "ValidatorError", "TimeComponent", "BaseComponent", "i", "U", "UploadComponent", "BaseComponent", "i", "FormComponent", "#form", "#state", "#formConfig", "U", "State", "errorContainer", "parent", "form", "formControlButtons", "components", "ok", "component", "event", "isValid", "#displayFormStatusNotofication", "notification"]
}
